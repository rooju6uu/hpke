Initial state
Game 1 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        return((skS: Z_t <- sk; {23}let (skE: Z_t, pkE_2: G_t) = (z <-R Z_t; (z, exp(g, z))) in dh_2: GG_t <- concatDH(exp(pk_R, skE), exp(pk_R, skS)); enc_1: bitstring <- Serialize(pkE_2); pkS: G_t <- exp(g, skS); kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS); zz_2: eae_output_t <- (key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2); info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2); ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info))); AuthEncap_tuple(zz_2, enc_1) else AuthEncap_None))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        return((skR: Z_t <- sk; let Serialize(pkE_3: G_t) = enc_2 in dh_3: GG_t <- concatDH(exp(pkE_3, skR), exp(pk_S, skR)); pkR_1: G_t <- exp(g, skR); kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S); zz_3: eae_output_t <- (key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3); info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3); ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1))); AuthDecap_Some(zz_3) else AuthDecap_None))
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying expand
  - Expand if/find/let
    - Simplify pattern (skE: Z_t, pkE_2: G_t) (tuple expanded) at 23
    - Remove else branch of let at 23
yields

Game 2 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        skS: Z_t <- sk;
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        skE: Z_t <- z;
        dh_2: GG_t <- concatDH(exp(pk_R, skE), exp(pk_R, skS));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, skS);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        skR: Z_t <- sk;
        let Serialize(pkE_3: G_t) = enc_2 in
          dh_3: GG_t <- concatDH(exp(pkE_3, skR), exp(pk_S, skR));
          pkR_1: G_t <- exp(g, skR);
          kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
          key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
          info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
          zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
          return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying remove assignments of findcond
  - Remove assignments on skR (definition removed, all usages removed)
  - Remove assignments on skS (definition removed, all usages removed)
  - Remove assignments on skE (definition removed, all usages removed)
yields

Game 3 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {116}    dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
          pkR_1: G_t <- exp(g, sk);
          kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
          key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
          info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
          zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
          return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying insert instruction find ie1_1 = ie1 <= Qe, i1_3 = i1_2 <= N suchthat
      defined(zz_2[ie1, i1_2], enc_1[ie1, i1_2], sk[i1_2], pk_R[ie1, i1_2])
      && (exp(g, sk) = pk_R[ie1, i1_2])
      && (exp(g, sk[i1_2]) = pk_S)
      && (enc_1[ie1, i1_2] = enc_2) then
    orfind id1_1 = id1 <= Qd suchthat
      defined(random_br[id1], zz_3[id1], enc_2[id1], pk_S[id1])
      && (pk_S[id1] = pk_S)
      && (enc_2[id1] = enc_2) then
    else
      find i1_1 = i1 <= N suchthat
          defined(sk[i1])
          && (pk_S = exp(g, sk[i1])) then
        random_br <- true at occurrence 116
yields

Game 4 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {116}    find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], enc_1[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && {124}((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (enc_1[ie1_3, i1_9] = enc_2)) then
            dh_3: GG_t <- {150}concatDH(exp(pkE_3, sk), exp(pk_S, sk));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_3))
          orfind id1_2 = id1_3 <= Qd suchthat defined(random_br[id1_3], zz_3[id1_3], enc_2[id1_3], pk_S[id1_3]) && {229}((pk_S[id1_3] = pk_S) && (enc_2[id1_3] = enc_2)) then
            dh_3: GG_t <- {245}concatDH(exp(pkE_3, sk), exp(pk_S, sk));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_3))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- true;
              dh_3: GG_t <- {329}concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying simplify
  - Simplification pass
    - Replaced concatDH(exp(pkE_3, sk), exp(pk_S, sk)) with concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk))) at 329
    - Replaced ((pk_S[id1_3] = pk_S) && (enc_2[id1_3] = enc_2)) with ((pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3)) at 229
    - Replaced concatDH(exp(pkE_3, sk), exp(pk_S, sk)) with concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk))) at 245
    - Replaced defined condition random_br[id1_3], zz_3[id1_3], enc_2[id1_3], pk_S[id1_3] with random_br[id1_3], zz_3[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3] in find at 116
    - Replaced ((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (enc_1[ie1_3, i1_9] = enc_2)) with ((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) at 124
    - Replaced concatDH(exp(pkE_3, sk), exp(pk_S, sk)) with concatDH(exp(g, mult(z[ie1_2, i1_8], sk)), exp(g, mult(sk[i1_8], sk))) at 150
    - Replaced defined condition zz_2[ie1_3, i1_9], enc_1[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9] with zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9] in find at 116
yields

Game 5 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(g, mult(z[ie1_2, i1_8], sk)), exp(g, mult(sk[i1_8], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some({222}zz_3))
          orfind id1_2 = id1_3 <= Qd suchthat defined(random_br[id1_3], zz_3[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_3))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- true;
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying replace term at occurrence 222 with zz_2[ie1_2, i1_8]
yields

Game 6 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(g, mult(z[ie1_2, i1_8], sk)), exp(g, mult(sk[i1_8], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(random_br[id1_3], zz_3[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_3))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- true;
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying remove assignments of useless
  - Remove assignments on random_br (definition point kept, all usages removed)
  - Remove assignments on zz_3 (definition point kept, all usages removed)
  - Remove assignments on key_1 (definition removed, all usages removed)
  - Remove assignments on info_1 (definition removed, all usages removed)
  - Remove assignments on dh_3 (definition removed, all usages removed)
  - Remove assignments on kemContext_3 (definition removed, all usages removed)
  - Remove assignments on pkR_1 (definition removed, all usages removed)
yields

Game 7 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_3: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(random_br[id1_3], zz_3[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some({258}zz_3))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- cst_bool;
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying replace term at occurrence 258 with zz_3[id1_2]
yields

Game 8 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_3: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_3[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_3[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- cst_bool;
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_3: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_3))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename zz_3
  - Rename variable zz_3 into zz_13, zz_12, zz_11, zz_10
yields

Game 9 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_10: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_10[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_10[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_11[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_11[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_12[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_13[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_13[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              random_br: bool <- cst_bool;
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying remove assignments of findcond
  - Remove assignments on random_br (definition removed, all usages removed)
yields

Game 10 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {116}    find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_10: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_10[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_10[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_11[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_11[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_12[id1_2]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_13[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_13[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying simplify
  - Simplification pass
    - Remove branch 5 in find at 116
    - Remove branch 3 in find at 116
    - Remove branch 2 in find at 116
    - Replaced defined condition zz_2[ie1_3, i1_9], z[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9] with zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9] in find at 116
yields

Game 11 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_10: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_3: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_3);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename dh_3
  - Rename variable dh_3 into dh_12, dh_11, dh_10
yields

Game 12 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            zz_10: eae_output_t <- cst_eae_output_t;
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            dh_10: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6[id1_2]], sk)));
            pkR_1: G_t <- exp(g, sk);
            kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
            key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_10);
            info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
            zz_11: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying remove assignments of findcond
  - Remove assignments on zz_10 (definition removed, all usages removed)
  - Remove assignments on zz_11 (definition removed, all usages removed)
  - Remove assignments on key_1 (definition removed, all usages removed)
  - Remove assignments on info_1 (definition removed, all usages removed)
  - Remove assignments on dh_10 (definition removed, all usages removed)
  - Remove assignments on kemContext_3 (definition removed, all usages removed)
  - Remove assignments on pkR_1 (definition removed, all usages removed)
yields

Game 13 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {116}    find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition zz_12[id1_3], sk[i1_6[id1_3]], pkE_3[id1_3], pk_S[id1_3] with zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3] in find at 116
yields

Game 14 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_3: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_3);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename kemContext_3
  - Rename variable kemContext_3 into kemContext_11, kemContext_10
yields

Game 15 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_1: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_1, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename key_1
  - Rename variable key_1 into key_6, key_5
yields

Game 16 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_1));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_1: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_1));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename info_1
  - Rename variable info_1 into info_6, info_5
yields

Game 17 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
  {18}  z <-R Z_t;
        pkE_2: G_t <- exp(g, z);
        dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
        enc_1: bitstring <- Serialize(pkE_2);
        pkS: G_t <- exp(g, sk);
        kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
        key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
        info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
        zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
        return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying insert instruction find i1 <= N suchthat
      defined(sk[i1])
      && pk_R = exp(g, sk[i1]) then at occurrence 18
yields

Game 18 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z <-R Z_t;
          pkE_2: G_t <- exp(g, z);
          dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
        else
          z <-R Z_t;
          pkE_2: G_t <- exp(g, z);
          dh_2: GG_t <- concatDH(exp(pk_R, z), exp(pk_R, sk));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename z
  - Rename variable z into z_3, z_2
yields

Game 19 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_2: GG_t <- {36}concatDH(exp(pk_R, z_2), exp(pk_R, sk));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_2: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying simplify
  - Simplification pass
    - Replaced concatDH(exp(pk_R, z_2), exp(pk_R, sk)) with concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk))) at 36
yields

Game 20 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_2: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_2: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_1: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_1))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename enc_1
  - Rename variable enc_1 into enc_8, enc_7
yields

Game 21 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_2: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_2: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_2);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename dh_2
  - Rename variable dh_2 into dh_14, dh_13
yields

Game 22 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_2: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_2, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_2[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && (exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_2[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename zz_2
  - Rename variable zz_2 into zz_15, zz_14
yields

Game 23 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {222}    find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && {230}((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_15[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9]) && {273}((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) then
            return(AuthDecap_Some(zz_15[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying simplify [probability (N * N + N * N * Qe) * PCollKey]
  - Simplification pass
    - Replaced ((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) with false at 273
    - Remove branch 2 in find at 222
    - Replaced ((exp(g, sk) = pk_R[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) with ((i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3)) at 230
    - Replaced defined condition zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], pk_R[ie1_3, i1_9] with zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9] in find at 222
yields

Game 24 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_2: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_2);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename kemContext_2
  - Rename variable kemContext_2 into kemContext_13, kemContext_12
yields

Game 25 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key, info));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename key
  - Rename variable key into key_8, key_7
yields

Game 26 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_7, info));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_8, info));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename info
  - Rename variable info into info_8, info_7
yields

Game 27 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_7, info_7));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_8, info_8));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_1: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_1: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_1, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying SA rename pkR_1
  - Rename variable pkR_1 into pkR_6, pkR_5
yields

Game 28 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_7, info_7));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_8, info_8));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
 {467}  return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying insert instruction let eae_input(
      salt: extract_salt_t,
      concatExtract(
        protocol1: label_protocol_t,
        suite1: suite_id_t,
        label1: label_extract_t,
        concatDH(dh1: G_t, dh2: G_t)),
      concatExpand(
        l: two_byte_t,
        protocol2: label_protocol_t,
        suite2: suite_id_t,
        label2: label_expand_t,
        concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in at occurrence 467
yields

Game 29 is
      Ostart() :=
      key_extr_3 <-R hash_key_t;
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_7, info_7));
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_8, info_8));
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_5, info_5));
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- ExtractAndExpand_inner(key_extr_3, eae_input(lbytes_empty, key_6, info_6));
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          return(ExtractAndExpand_inner(key_extr_3, x1))
        else
          return(ExtractAndExpand_inner(key_extr_3, x1))
      ))


Applying equivalence rom(ExtractAndExpand_inner)
  - Equivalence rom(ExtractAndExpand_inner) with variables: key_extr_3 -> hk
yields

Game 30 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- (x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7); {104}find [unique] u_70 = ri_70 <= Qe, u_71 = ri_71 <= N suchthat defined(x_O[ri_70, ri_71], r[ri_70, ri_71]) && (x_O_1 = x_O[ri_70, ri_71]) then r[u_70, u_71] orfind u_68 = ri_68 <= Qe, u_69 = ri_69 <= N suchthat defined(x_O_1[ri_68, ri_69], r_1[ri_68, ri_69]) && (x_O_1 = x_O_1[ri_68, ri_69]) then r_1[u_68, u_69] orfind u_66 = ri_66 <= Qd, u_67 = ri_67 <= N suchthat defined(x_O_2[ri_66, ri_67], r_2[ri_66, ri_67]) && (x_O_1 = x_O_2[ri_66, ri_67]) then r_2[u_66, u_67] orfind u_64 = ri_64 <= Qd, u_65 = ri_65 <= N suchthat defined(x_O_3[ri_64, ri_65], r_3[ri_64, ri_65]) && (x_O_1 = x_O_3[ri_64, ri_65]) then r_3[u_64, u_65] orfind u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(x_O_4[ri_62, ri_63], r_4[ri_62, ri_63]) && (x_O_1 = x_O_4[ri_62, ri_63]) then r_4[u_62, u_63] orfind u_60 = ri_60 <= Qh, u_61 = ri_61 <= N suchthat defined(x_O_5[ri_60, ri_61], r_5[ri_60, ri_61]) && {199}(x_O_1 = x_O_5[ri_60, ri_61]) then r_5[u_60, u_61] else r_1 <-R eae_output_t; r_1);
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- (x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8); {306}find [unique] u_58 = ri_58 <= Qe, u_59 = ri_59 <= N suchthat defined(x_O[ri_58, ri_59], r[ri_58, ri_59]) && (x_O = x_O[ri_58, ri_59]) then r[u_58, u_59] orfind u_56 = ri_56 <= Qe, u_57 = ri_57 <= N suchthat defined(x_O_1[ri_56, ri_57], r_1[ri_56, ri_57]) && (x_O = x_O_1[ri_56, ri_57]) then r_1[u_56, u_57] orfind u_54 = ri_54 <= Qd, u_55 = ri_55 <= N suchthat defined(x_O_2[ri_54, ri_55], r_2[ri_54, ri_55]) && (x_O = x_O_2[ri_54, ri_55]) then r_2[u_54, u_55] orfind u_52 = ri_52 <= Qd, u_53 = ri_53 <= N suchthat defined(x_O_3[ri_52, ri_53], r_3[ri_52, ri_53]) && (x_O = x_O_3[ri_52, ri_53]) then r_3[u_52, u_53] orfind u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(x_O_4[ri_50, ri_51], r_4[ri_50, ri_51]) && (x_O = x_O_4[ri_50, ri_51]) then r_4[u_50, u_51] orfind u_48 = ri_48 <= Qh, u_49 = ri_49 <= N suchthat defined(x_O_5[ri_48, ri_49], r_5[ri_48, ri_49]) && {401}(x_O = x_O_5[ri_48, ri_49]) then r_5[u_48, u_49] else r <-R eae_output_t; r);
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- (x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5); {587}find [unique] u_46 = ri_46 <= Qe, u_47 = ri_47 <= N suchthat defined(x_O[ri_46, ri_47], r[ri_46, ri_47]) && (x_O_3 = x_O[ri_46, ri_47]) then r[u_46, u_47] orfind u_44 = ri_44 <= Qe, u_45 = ri_45 <= N suchthat defined(x_O_1[ri_44, ri_45], r_1[ri_44, ri_45]) && (x_O_3 = x_O_1[ri_44, ri_45]) then r_1[u_44, u_45] orfind u_42 = ri_42 <= Qd, u_43 = ri_43 <= N suchthat defined(x_O_2[ri_42, ri_43], r_2[ri_42, ri_43]) && (x_O_3 = x_O_2[ri_42, ri_43]) then r_2[u_42, u_43] orfind u_40 = ri_40 <= Qd, u_41 = ri_41 <= N suchthat defined(x_O_3[ri_40, ri_41], r_3[ri_40, ri_41]) && (x_O_3 = x_O_3[ri_40, ri_41]) then r_3[u_40, u_41] orfind u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(x_O_4[ri_38, ri_39], r_4[ri_38, ri_39]) && (x_O_3 = x_O_4[ri_38, ri_39]) then r_4[u_38, u_39] orfind u_36 = ri_36 <= Qh, u_37 = ri_37 <= N suchthat defined(x_O_5[ri_36, ri_37], r_5[ri_36, ri_37]) && {682}(x_O_3 = x_O_5[ri_36, ri_37]) then r_5[u_36, u_37] else r_3 <-R eae_output_t; r_3);
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- (x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6); {771}find [unique] u_34 = ri_34 <= Qe, u_35 = ri_35 <= N suchthat defined(x_O[ri_34, ri_35], r[ri_34, ri_35]) && (x_O_2 = x_O[ri_34, ri_35]) then r[u_34, u_35] orfind u_32 = ri_32 <= Qe, u_33 = ri_33 <= N suchthat defined(x_O_1[ri_32, ri_33], r_1[ri_32, ri_33]) && (x_O_2 = x_O_1[ri_32, ri_33]) then r_1[u_32, u_33] orfind u_30 = ri_30 <= Qd, u_31 = ri_31 <= N suchthat defined(x_O_2[ri_30, ri_31], r_2[ri_30, ri_31]) && (x_O_2 = x_O_2[ri_30, ri_31]) then r_2[u_30, u_31] orfind u_28 = ri_28 <= Qd, u_29 = ri_29 <= N suchthat defined(x_O_3[ri_28, ri_29], r_3[ri_28, ri_29]) && (x_O_2 = x_O_3[ri_28, ri_29]) then r_3[u_28, u_29] orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(x_O_4[ri_26, ri_27], r_4[ri_26, ri_27]) && (x_O_2 = x_O_4[ri_26, ri_27]) then r_4[u_26, u_27] orfind u_24 = ri_24 <= Qh, u_25 = ri_25 <= N suchthat defined(x_O_5[ri_24, ri_25], r_5[ri_24, ri_25]) && {866}(x_O_2 = x_O_5[ri_24, ri_25]) then r_5[u_24, u_25] else r_2 <-R eae_output_t; r_2);
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          return((x_O_4: eae_input_t <- x1; {924}find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(x_O[ri_22, ri_23], r[ri_22, ri_23]) && (x_O_4 = x_O[ri_22, ri_23]) then r[u_22, u_23] orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(x_O_1[ri_20, ri_21], r_1[ri_20, ri_21]) && (x_O_4 = x_O_1[ri_20, ri_21]) then r_1[u_20, u_21] orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(x_O_2[ri_18, ri_19], r_2[ri_18, ri_19]) && (x_O_4 = x_O_2[ri_18, ri_19]) then r_2[u_18, u_19] orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(x_O_3[ri_16, ri_17], r_3[ri_16, ri_17]) && (x_O_4 = x_O_3[ri_16, ri_17]) then r_3[u_16, u_17] orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(x_O_4[ri_14, ri_15], r_4[ri_14, ri_15]) && (x_O_4 = x_O_4[ri_14, ri_15]) then r_4[u_14, u_15] orfind u_12 = ri_12 <= Qh, u_13 = ri_13 <= N suchthat defined(x_O_5[ri_12, ri_13], r_5[ri_12, ri_13]) && {1019}(x_O_4 = x_O_5[ri_12, ri_13]) then r_5[u_12, u_13] else r_4 <-R eae_output_t; r_4))
        else
          return((x_O_5: eae_input_t <- x1; {1044}find [unique] u_10 = ri_10 <= Qe, u_11 = ri_11 <= N suchthat defined(x_O[ri_10, ri_11], r[ri_10, ri_11]) && {1049}(x_O_5 = x_O[ri_10, ri_11]) then r[u_10, u_11] orfind u_8 = ri_8 <= Qe, u_9 = ri_9 <= N suchthat defined(x_O_1[ri_8, ri_9], r_1[ri_8, ri_9]) && {1067}(x_O_5 = x_O_1[ri_8, ri_9]) then r_1[u_8, u_9] orfind u_6 = ri_6 <= Qd, u_7 = ri_7 <= N suchthat defined(x_O_2[ri_6, ri_7], r_2[ri_6, ri_7]) && {1085}(x_O_5 = x_O_2[ri_6, ri_7]) then r_2[u_6, u_7] orfind u_4 = ri_4 <= Qd, u_5 = ri_5 <= N suchthat defined(x_O_3[ri_4, ri_5], r_3[ri_4, ri_5]) && {1103}(x_O_5 = x_O_3[ri_4, ri_5]) then r_3[u_4, u_5] orfind u_2 = ri_2 <= Qh, u_3 = ri_3 <= N suchthat defined(x_O_4[ri_2, ri_3], r_4[ri_2, ri_3]) && {1121}(x_O_5 = x_O_4[ri_2, ri_3]) then r_4[u_2, u_3] orfind u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(x_O_5[ri, ri_1], r_5[ri, ri_1]) && (x_O_5 = x_O_5[ri, ri_1]) then r_5[u, u_1] else r_5 <-R eae_output_t; r_5))
      ))


Applying simplify (non-expanded game) [probability N * N * PCollKey]
  - Simplification pass
    - Replaced (x_O_1 = x_O_5[ri_60, ri_61]) with false at 199
    - Remove branch 6 in find at 104
    - Replaced (x_O = x_O_5[ri_48, ri_49]) with false at 401
    - Remove branch 6 in find at 306
    - Replaced (x_O_3 = x_O_5[ri_36, ri_37]) with false at 682
    - Remove branch 6 in find at 587
    - Replaced (x_O_2 = x_O_5[ri_24, ri_25]) with false at 866
    - Remove branch 6 in find at 771
    - Replaced (x_O_4 = x_O_5[ri_12, ri_13]) with false at 1019
    - Remove branch 6 in find at 924
    - Replaced (x_O_5 = x_O_4[ri_2, ri_3]) with false at 1121
    - Remove branch 5 in find at 1044
    - Replaced (x_O_5 = x_O_3[ri_4, ri_5]) with false at 1103
    - Remove branch 4 in find at 1044
    - Replaced (x_O_5 = x_O_2[ri_6, ri_7]) with false at 1085
    - Remove branch 3 in find at 1044
    - Replaced (x_O_5 = x_O_1[ri_8, ri_9]) with false at 1067
    - Remove branch 2 in find at 1044
    - Replaced (x_O_5 = x_O[ri_10, ri_11]) with false at 1049
    - Remove branch 1 in find at 1044
yields

Game 31 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          zz_14: eae_output_t <- (x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7); {104}find [unique] u_70 = ri_70 <= Qe, u_71 = ri_71 <= N suchthat defined(x_O[ri_70, ri_71], r[ri_70, ri_71]) && (x_O_1 = x_O[ri_70, ri_71]) then r[u_70, u_71] orfind u_68 = ri_68 <= Qe, u_69 = ri_69 <= N suchthat defined(x_O_1[ri_68, ri_69], r_1[ri_68, ri_69]) && (x_O_1 = x_O_1[ri_68, ri_69]) then r_1[u_68, u_69] orfind u_66 = ri_66 <= Qd, u_67 = ri_67 <= N suchthat defined(x_O_2[ri_66, ri_67], r_2[ri_66, ri_67]) && (x_O_1 = x_O_2[ri_66, ri_67]) then r_2[u_66, u_67] orfind u_64 = ri_64 <= Qd, u_65 = ri_65 <= N suchthat defined(x_O_3[ri_64, ri_65], r_3[ri_64, ri_65]) && (x_O_1 = x_O_3[ri_64, ri_65]) then r_3[u_64, u_65] orfind u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(x_O_4[ri_62, ri_63], r_4[ri_62, ri_63]) && (x_O_1 = x_O_4[ri_62, ri_63]) then r_4[u_62, u_63] else r_1 <-R eae_output_t; r_1);
          return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          zz_15: eae_output_t <- (x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8); {288}find [unique] u_58 = ri_58 <= Qe, u_59 = ri_59 <= N suchthat defined(x_O[ri_58, ri_59], r[ri_58, ri_59]) && (x_O = x_O[ri_58, ri_59]) then r[u_58, u_59] orfind u_56 = ri_56 <= Qe, u_57 = ri_57 <= N suchthat defined(x_O_1[ri_56, ri_57], r_1[ri_56, ri_57]) && (x_O = x_O_1[ri_56, ri_57]) then r_1[u_56, u_57] orfind u_54 = ri_54 <= Qd, u_55 = ri_55 <= N suchthat defined(x_O_2[ri_54, ri_55], r_2[ri_54, ri_55]) && (x_O = x_O_2[ri_54, ri_55]) then r_2[u_54, u_55] orfind u_52 = ri_52 <= Qd, u_53 = ri_53 <= N suchthat defined(x_O_3[ri_52, ri_53], r_3[ri_52, ri_53]) && (x_O = x_O_3[ri_52, ri_53]) then r_3[u_52, u_53] orfind u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(x_O_4[ri_50, ri_51], r_4[ri_50, ri_51]) && (x_O = x_O_4[ri_50, ri_51]) then r_4[u_50, u_51] else r <-R eae_output_t; r);
          return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              zz_12: eae_output_t <- (x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5); {551}find [unique] u_46 = ri_46 <= Qe, u_47 = ri_47 <= N suchthat defined(x_O[ri_46, ri_47], r[ri_46, ri_47]) && (x_O_3 = x_O[ri_46, ri_47]) then r[u_46, u_47] orfind u_44 = ri_44 <= Qe, u_45 = ri_45 <= N suchthat defined(x_O_1[ri_44, ri_45], r_1[ri_44, ri_45]) && (x_O_3 = x_O_1[ri_44, ri_45]) then r_1[u_44, u_45] orfind u_42 = ri_42 <= Qd, u_43 = ri_43 <= N suchthat defined(x_O_2[ri_42, ri_43], r_2[ri_42, ri_43]) && (x_O_3 = x_O_2[ri_42, ri_43]) then r_2[u_42, u_43] orfind u_40 = ri_40 <= Qd, u_41 = ri_41 <= N suchthat defined(x_O_3[ri_40, ri_41], r_3[ri_40, ri_41]) && (x_O_3 = x_O_3[ri_40, ri_41]) then r_3[u_40, u_41] orfind u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(x_O_4[ri_38, ri_39], r_4[ri_38, ri_39]) && (x_O_3 = x_O_4[ri_38, ri_39]) then r_4[u_38, u_39] else r_3 <-R eae_output_t; r_3);
              return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              zz_13: eae_output_t <- (x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6); {717}find [unique] u_34 = ri_34 <= Qe, u_35 = ri_35 <= N suchthat defined(x_O[ri_34, ri_35], r[ri_34, ri_35]) && (x_O_2 = x_O[ri_34, ri_35]) then r[u_34, u_35] orfind u_32 = ri_32 <= Qe, u_33 = ri_33 <= N suchthat defined(x_O_1[ri_32, ri_33], r_1[ri_32, ri_33]) && (x_O_2 = x_O_1[ri_32, ri_33]) then r_1[u_32, u_33] orfind u_30 = ri_30 <= Qd, u_31 = ri_31 <= N suchthat defined(x_O_2[ri_30, ri_31], r_2[ri_30, ri_31]) && (x_O_2 = x_O_2[ri_30, ri_31]) then r_2[u_30, u_31] orfind u_28 = ri_28 <= Qd, u_29 = ri_29 <= N suchthat defined(x_O_3[ri_28, ri_29], r_3[ri_28, ri_29]) && (x_O_2 = x_O_3[ri_28, ri_29]) then r_3[u_28, u_29] orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(x_O_4[ri_26, ri_27], r_4[ri_26, ri_27]) && (x_O_2 = x_O_4[ri_26, ri_27]) then r_4[u_26, u_27] else r_2 <-R eae_output_t; r_2);
              return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          return((x_O_4: eae_input_t <- x1; find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(x_O[ri_22, ri_23], r[ri_22, ri_23]) && (x_O_4 = x_O[ri_22, ri_23]) then r[u_22, u_23] orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(x_O_1[ri_20, ri_21], r_1[ri_20, ri_21]) && (x_O_4 = x_O_1[ri_20, ri_21]) then r_1[u_20, u_21] orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(x_O_2[ri_18, ri_19], r_2[ri_18, ri_19]) && (x_O_4 = x_O_2[ri_18, ri_19]) then r_2[u_18, u_19] orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(x_O_3[ri_16, ri_17], r_3[ri_16, ri_17]) && (x_O_4 = x_O_3[ri_16, ri_17]) then r_3[u_16, u_17] orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(x_O_4[ri_14, ri_15], r_4[ri_14, ri_15]) && (x_O_4 = x_O_4[ri_14, ri_15]) then r_4[u_14, u_15] else r_4 <-R eae_output_t; r_4))
        else
          return((x_O_5: eae_input_t <- x1; find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(x_O_5[ri, ri_1], r_5[ri, ri_1]) && (x_O_5 = x_O_5[ri, ri_1]) then r_5[u, u_1] else r_5 <-R eae_output_t; r_5))
      ))


Applying expand [probability (4 * Qe * Qe * N + N * N + N * N * Qe + N * N * Qd) * PCollKey]
  - Expand if/find/let
    - Remove branch 4 in find at 717
    - Remove branch 2 in find at 717
    - Remove branch 1 in find at 717
    - Remove branch 3 in find at 551
    - Remove branch 1 in find at 551
    - Remove branch 4 in find at 288
    - Remove branch 3 in find at 288
    - Remove branch 2 in find at 288
    - Remove branch 1 in find at 288
    - Remove branch 3 in find at 104
    - Remove branch 2 in find at 104
    - Remove branch 1 in find at 104
yields

Game 32 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7);
          find [unique] u_64 = ri_64 <= Qd, u_65 = ri_65 <= N suchthat defined(x_O_3[ri_64, ri_65], r_3[ri_64, ri_65]) && (x_O_1 = x_O_3[ri_64, ri_65]) then
            zz_14: eae_output_t <- r_3[u_64, u_65];
            return(AuthEncap_tuple(zz_14, enc_7))
          orfind u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(x_O_4[ri_62, ri_63], r_4[ri_62, ri_63]) && (x_O_1 = x_O_4[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(zz_14, enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(zz_14, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(x_O_4[ri_50, ri_51], r_4[ri_50, ri_51]) && (x_O = x_O_4[ri_50, ri_51]) then
            zz_15: eae_output_t <- r_4[u_50, u_51];
            return(AuthEncap_tuple(zz_15, enc_8))
          else
            r <-R eae_output_t;
            zz_15: eae_output_t <- r;
            return(AuthEncap_tuple(zz_15, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5);
              find [unique] u_44 = ri_44 <= Qe, u_45 = ri_45 <= N suchthat defined(x_O_1[ri_44, ri_45], r_1[ri_44, ri_45]) && (x_O_3 = x_O_1[ri_44, ri_45]) then
                zz_12: eae_output_t <- r_1[u_44, u_45];
                return(AuthDecap_Some(zz_12))
              orfind u_40 = ri_40 <= Qd, u_41 = ri_41 <= N suchthat defined(x_O_3[ri_40, ri_41], r_3[ri_40, ri_41]) && (x_O_3 = x_O_3[ri_40, ri_41]) then
                zz_12: eae_output_t <- r_3[u_40, u_41];
                return(AuthDecap_Some(zz_12))
              orfind u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(x_O_4[ri_38, ri_39], r_4[ri_38, ri_39]) && (x_O_3 = x_O_4[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(zz_12))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(zz_12))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6);
              find [unique] u_30 = ri_30 <= Qd, u_31 = ri_31 <= N suchthat defined(x_O_2[ri_30, ri_31], r_2[ri_30, ri_31]) && (x_O_2 = x_O_2[ri_30, ri_31]) then
                zz_13: eae_output_t <- r_2[u_30, u_31];
                return(AuthDecap_Some(zz_13))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(x_O_4[ri_26, ri_27], r_4[ri_26, ri_27]) && (x_O_2 = x_O_4[ri_26, ri_27]) then
                zz_13: eae_output_t <- r_4[u_26, u_27];
                return(AuthDecap_Some(zz_13))
              else
                r_2 <-R eae_output_t;
                zz_13: eae_output_t <- r_2;
                return(AuthDecap_Some(zz_13))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          x_O_4: eae_input_t <- x1;
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(x_O[ri_22, ri_23], r[ri_22, ri_23]) && (x_O_4 = x_O[ri_22, ri_23]) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(x_O_1[ri_20, ri_21], r_1[ri_20, ri_21]) && (x_O_4 = x_O_1[ri_20, ri_21]) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(x_O_2[ri_18, ri_19], r_2[ri_18, ri_19]) && (x_O_4 = x_O_2[ri_18, ri_19]) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(x_O_3[ri_16, ri_17], r_3[ri_16, ri_17]) && (x_O_4 = x_O_3[ri_16, ri_17]) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(x_O_4[ri_14, ri_15], r_4[ri_14, ri_15]) && (x_O_4 = x_O_4[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          x_O_5: eae_input_t <- x1;
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(x_O_5[ri, ri_1], r_5[ri, ri_1]) && (x_O_5 = x_O_5[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_O_5 (definition point kept, all usages removed)
  - Remove assignments on x_O_4 (definition point kept, all usages removed)
  - Remove assignments on zz_13 (definition removed, all usages removed)
  - Remove assignments on zz_13 (definition removed, all usages removed)
  - Remove assignments on zz_13 (definition removed, all usages removed)
  - Remove assignments on zz_12 (definition kept, array references kept)
  - Remove assignments on zz_12 (definition kept, array references kept)
  - Remove assignments on zz_12 (definition kept, array references kept)
  - Remove assignments on zz_12 (definition kept, array references kept)
  - Remove assignments on zz_15 (definition removed, all usages removed)
  - Remove assignments on zz_15 (definition removed, all usages removed)
  - Remove assignments on zz_14 (definition kept, array references kept)
  - Remove assignments on zz_14 (definition kept, array references kept)
  - Remove assignments on zz_14 (definition kept, array references kept)
yields

Game 33 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7);
 {103}    find [unique] u_64 = ri_64 <= Qd, u_65 = ri_65 <= N suchthat defined(x_O_3[ri_64, ri_65], r_3[ri_64, ri_65]) && {108}(x_O_1 = x_O_3[ri_64, ri_65]) then
            zz_14: eae_output_t <- r_3[u_64, u_65];
            return(AuthEncap_tuple(r_3[u_64, u_65], enc_7))
          orfind u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(x1[ri_62, ri_63], x_O_4[ri_62, ri_63], r_4[ri_62, ri_63]) && {144}(x_O_1 = x1[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8);
 {268}    find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(x1[ri_50, ri_51], x_O_4[ri_50, ri_51], r_4[ri_50, ri_51]) && {275}(x_O = x1[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5);
 {464}        find [unique] u_44 = ri_44 <= Qe, u_45 = ri_45 <= N suchthat defined(x_O_1[ri_44, ri_45], r_1[ri_44, ri_45]) && {469}(x_O_3 = x_O_1[ri_44, ri_45]) then
                zz_12: eae_output_t <- r_1[u_44, u_45];
                return(AuthDecap_Some(r_1[u_44, u_45]))
              orfind u_40 = ri_40 <= Qd, u_41 = ri_41 <= N suchthat defined(x_O_3[ri_40, ri_41], r_3[ri_40, ri_41]) && {500}(x_O_3 = x_O_3[ri_40, ri_41]) then
                zz_12: eae_output_t <- r_3[u_40, u_41];
                return(AuthDecap_Some(r_3[u_40, u_41]))
              orfind u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(x1[ri_38, ri_39], x_O_4[ri_38, ri_39], r_4[ri_38, ri_39]) && {533}(x_O_3 = x1[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6);
 {636}        find [unique] u_30 = ri_30 <= Qd, u_31 = ri_31 <= N suchthat defined(x_O_2[ri_30, ri_31], r_2[ri_30, ri_31]) && {641}(x_O_2 = x_O_2[ri_30, ri_31]) then
                return(AuthDecap_Some(r_2[u_30, u_31]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(x1[ri_26, ri_27], x_O_4[ri_26, ri_27], r_4[ri_26, ri_27]) && {665}(x_O_2 = x1[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          x_O_4: eae_input_t <- cst_eae_input_t;
 {720}    find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(x_O[ri_22, ri_23], r[ri_22, ri_23]) && {725}(x1 = x_O[ri_22, ri_23]) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(x_O_1[ri_20, ri_21], r_1[ri_20, ri_21]) && {746}(x1 = x_O_1[ri_20, ri_21]) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(x_O_2[ri_18, ri_19], r_2[ri_18, ri_19]) && {767}(x1 = x_O_2[ri_18, ri_19]) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(x_O_3[ri_16, ri_17], r_3[ri_16, ri_17]) && {788}(x1 = x_O_3[ri_16, ri_17]) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(x1[ri_14, ri_15], x_O_4[ri_14, ri_15], r_4[ri_14, ri_15]) && {811}(x1 = x1[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          x_O_5: eae_input_t <- cst_eae_input_t;
 {838}    find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(x1[ri, ri_1], x_O_5[ri, ri_1], r_5[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying simplify [probability (8 * N * N + N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced defined condition x1[ri, ri_1], x_O_5[ri, ri_1], r_5[ri, ri_1] with r_5[ri, ri_1], x1[ri, ri_1] in find at 838
    - Replaced (x1 = x1[ri_14, ri_15]) with ((pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15])) at 811
    - Replaced defined condition x1[ri_14, ri_15], x_O_4[ri_14, ri_15], r_4[ri_14, ri_15] with r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15] in find at 720
    - Replaced (x1 = x_O_3[ri_16, ri_17]) with ((pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_6[ri_16, ri_17]], sk[ri_17]))) && (dh1 = exp(pkE_3[ri_16, ri_17], sk[ri_17])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty)) at 788
    - Replaced defined condition x_O_3[ri_16, ri_17], r_3[ri_16, ri_17] with r_3[ri_16, ri_17], sk[ri_17], sk[i1_6[ri_16, ri_17]], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17] in find at 720
    - Replaced (x1 = x_O_2[ri_18, ri_19]) with ((pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty)) at 767
    - Replaced defined condition x_O_2[ri_18, ri_19], r_2[ri_18, ri_19] with r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19] in find at 720
    - Replaced (x1 = x_O_1[ri_20, ri_21]) with ((pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_10[ri_20, ri_21]], sk[ri_21]))) && (dh1 = exp(g, mult(sk[i1_10[ri_20, ri_21]], z_2[ri_20, ri_21]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty)) at 746
    - Replaced defined condition x_O_1[ri_20, ri_21], r_1[ri_20, ri_21] with r_1[ri_20, ri_21], z_2[ri_20, ri_21], sk[ri_21], sk[i1_10[ri_20, ri_21]], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21] in find at 720
    - Replaced (x1 = x_O[ri_22, ri_23]) with ((pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty)) at 725
    - Replaced defined condition x_O[ri_22, ri_23], r[ri_22, ri_23] with r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23] in find at 720
    - Replaced (x_O_2 = x1[ri_26, ri_27]) with ((pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (exp(pk_S, sk) = dh2[ri_26, ri_27]) && (exp(pkE_3, sk) = dh1[ri_26, ri_27]) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27])) at 665
    - Replaced defined condition x1[ri_26, ri_27], x_O_4[ri_26, ri_27], r_4[ri_26, ri_27] with r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27] in find at 636
    - Replaced (x_O_2 = x_O_2[ri_30, ri_31]) with ((pk_S = pk_S[ri_30, ri_31]) && (i = ri_31) && (pkE_3 = pkE_3[ri_30, ri_31])) at 641
    - In branch 1 of find at 636, substituting u_31 with i
    - Replaced defined condition x_O_2[ri_30, ri_31], r_2[ri_30, ri_31] with r_2[ri_30], pkE_3[ri_30], pk_S[ri_30] in find at 636
    - Replaced (x_O_3 = x1[ri_38, ri_39]) with ((pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (exp(g, mult(sk[i1_6], sk)) = dh2[ri_38, ri_39]) && (exp(pkE_3, sk) = dh1[ri_38, ri_39]) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39])) at 533
    - Replaced defined condition x1[ri_38, ri_39], x_O_4[ri_38, ri_39], r_4[ri_38, ri_39] with r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39] in find at 464
    - Replaced (x_O_3 = x_O_3[ri_40, ri_41]) with ((i1_6[id, ri_41] = i1_6[ri_40, ri_41]) && (i = ri_41) && (pkE_3 = pkE_3[ri_40, ri_41])) at 500
    - Remove branch 2 in find at 464
    - Replaced (x_O_3 = x_O_1[ri_44, ri_45]) with ((i1_6 = ri_45) && (i = i1_10[ri_44, ri_45]) && (pkE_3 = pkE_2[ri_44, ri_45])) at 469
    - Remove branch 1 in find at 464
    - Replaced (x_O = x1[ri_50, ri_51]) with ((pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (exp(pk_R, sk) = dh2[ri_50, ri_51]) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51])) at 275
    - Replaced defined condition x1[ri_50, ri_51], x_O_4[ri_50, ri_51], r_4[ri_50, ri_51] with r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51] in find at 268
    - Replaced (x_O_1 = x1[ri_62, ri_63]) with ((pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], sk)) = dh2[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], z_2)) = dh1[ri_62, ri_63]) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63])) at 144
    - Replaced defined condition x1[ri_62, ri_63], x_O_4[ri_62, ri_63], r_4[ri_62, ri_63] with r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63] in find at 103
    - Replaced (x_O_1 = x_O_3[ri_64, ri_65]) with ((i = i1_6[ri_64, ri_65]) && (i1_10 = ri_65) && (pkE_2 = pkE_3[ri_64, ri_65])) at 108
    - In branch 1 of find at 103, substituting u_65 with i1_10
    - Replaced defined condition x_O_3[ri_64, ri_65], r_3[ri_64, ri_65] with r_3[ri_64, i1_10], pkE_3[ri_64, i1_10], i1_6[ri_64, i1_10] in find at 103
yields

Game 34 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7);
 {103}    find [unique] u_64 = ri_64 <= Qd suchthat defined(r_3[ri_64, i1_10], pkE_3[ri_64, i1_10], i1_6[ri_64, i1_10]) && {116}((i = i1_6[ri_64, i1_10]) && (i1_10 = i1_10) && (pkE_2 = pkE_3[ri_64, i1_10])) then
            u_65 <= N <- i1_10;
            zz_14: eae_output_t <- r_3[u_64, i1_10];
            return(AuthEncap_tuple(r_3[u_64, i1_10], enc_7))
          orfind u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63]) && (pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], sk)) = dh2[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], z_2)) = dh1[ri_62, ri_63]) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (exp(pk_R, sk) = dh2[ri_50, ri_51]) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5);
              find [unique] u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39]) && (pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (exp(g, mult(sk[i1_6], sk)) = dh2[ri_38, ri_39]) && (exp(pkE_3, sk) = dh1[ri_38, ri_39]) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && {950}((pk_S = pk_S[ri_30]) && (i = i) && (pkE_3 = pkE_3[ri_30])) then
                u_31 <= N <- i;
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (exp(pk_S, sk) = dh2[ri_26, ri_27]) && (exp(pkE_3, sk) = dh1[ri_26, ri_27]) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          x_O_4: eae_input_t <- cst_eae_input_t;
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(r_1[ri_20, ri_21], z_2[ri_20, ri_21], sk[ri_21], sk[i1_10[ri_20, ri_21]], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21]) && (pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_10[ri_20, ri_21]], sk[ri_21]))) && (dh1 = exp(g, mult(sk[i1_10[ri_20, ri_21]], z_2[ri_20, ri_21]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(r_3[ri_16, ri_17], sk[ri_17], sk[i1_6[ri_16, ri_17]], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17]) && (pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_6[ri_16, ri_17]], sk[ri_17]))) && (dh1 = exp(pkE_3[ri_16, ri_17], sk[ri_17])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          x_O_5: eae_input_t <- cst_eae_input_t;
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying simplify [probability (N * Qe * Qd + N * N + N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced ((pk_S = pk_S[ri_30]) && (i = i) && (pkE_3 = pkE_3[ri_30])) with ((pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30])) at 950
    - Replaced ((i = i1_6[ri_64, i1_10]) && (i1_10 = i1_10) && (pkE_2 = pkE_3[ri_64, i1_10])) with false at 116
    - Remove branch 1 in find at 103
yields

Game 35 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_12: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_7: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_13);
          info_7: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_12);
          x_O_1: eae_input_t <- eae_input(lbytes_empty, key_7, info_7);
          find [unique] u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63]) && (pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], sk)) = dh2[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], z_2)) = dh1[ri_62, ri_63]) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          kemContext_13: GGG_t <- concatContext(pkE_2, pk_R, pkS);
          key_8: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_14);
          info_8: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_13);
          x_O: eae_input_t <- eae_input(lbytes_empty, key_8, info_8);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (exp(pk_R, sk) = dh2[ri_50, ri_51]) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              kemContext_10: GGG_t <- concatContext(pkE_3, pkR_5, pk_S);
              key_5: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_11);
              info_5: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_10);
              x_O_3: eae_input_t <- eae_input(lbytes_empty, key_5, info_5);
              find [unique] u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39]) && (pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (exp(g, mult(sk[i1_6], sk)) = dh2[ri_38, ri_39]) && (exp(pkE_3, sk) = dh1[ri_38, ri_39]) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              kemContext_11: GGG_t <- concatContext(pkE_3, pkR_6, pk_S);
              key_6: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_12);
              info_6: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_11);
              x_O_2: eae_input_t <- eae_input(lbytes_empty, key_6, info_6);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                u_31 <= N <- i;
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (exp(pk_S, sk) = dh2[ri_26, ri_27]) && (exp(pkE_3, sk) = dh1[ri_26, ri_27]) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          x_O_4: eae_input_t <- cst_eae_input_t;
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(r_1[ri_20, ri_21], z_2[ri_20, ri_21], sk[ri_21], sk[i1_10[ri_20, ri_21]], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21]) && (pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_10[ri_20, ri_21]], sk[ri_21]))) && (dh1 = exp(g, mult(sk[i1_10[ri_20, ri_21]], z_2[ri_20, ri_21]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(r_3[ri_16, ri_17], sk[ri_17], sk[i1_6[ri_16, ri_17]], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17]) && (pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_6[ri_16, ri_17]], sk[ri_17]))) && (dh1 = exp(pkE_3[ri_16, ri_17], sk[ri_17])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          x_O_5: eae_input_t <- cst_eae_input_t;
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying move all binders
  - Move assignment to x_O_5
  - Move assignment to x_O_4
  - Move assignment to x_O_2
  - Move assignment to info_6
  - Move assignment to key_6
  - Move assignment to kemContext_11
  - Move assignment to x_O_3
  - Move assignment to info_5
  - Move assignment to key_5
  - Move assignment to kemContext_10
  - Move assignment to x_O
  - Move assignment to info_8
  - Move assignment to key_8
  - Move assignment to kemContext_13
  - Move assignment to x_O_1
  - Move assignment to info_7
  - Move assignment to key_7
  - Move assignment to kemContext_12
yields

Game 36 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          dh_13: GG_t <- concatDH(exp(g, mult(sk[i1_10], z_2)), exp(g, mult(sk[i1_10], sk)));
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63]) && (pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], sk)) = dh2[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], z_2)) = dh1[ri_62, ri_63]) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          dh_14: GG_t <- concatDH(exp(pk_R, z_3), exp(pk_R, sk));
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (exp(pk_R, sk) = dh2[ri_50, ri_51]) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              dh_11: GG_t <- concatDH(exp(pkE_3, sk), exp(g, mult(sk[i1_6], sk)));
              pkR_5: G_t <- exp(g, sk);
              find [unique] u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39]) && (pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (exp(g, mult(sk[i1_6], sk)) = dh2[ri_38, ri_39]) && (exp(pkE_3, sk) = dh1[ri_38, ri_39]) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              dh_12: GG_t <- concatDH(exp(pkE_3, sk), exp(pk_S, sk));
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                u_31 <= N <- i;
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (exp(pk_S, sk) = dh2[ri_26, ri_27]) && (exp(pkE_3, sk) = dh1[ri_26, ri_27]) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(r_1[ri_20, ri_21], z_2[ri_20, ri_21], sk[ri_21], sk[i1_10[ri_20, ri_21]], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21]) && (pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_10[ri_20, ri_21]], sk[ri_21]))) && (dh1 = exp(g, mult(sk[i1_10[ri_20, ri_21]], z_2[ri_20, ri_21]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(r_3[ri_16, ri_17], sk[ri_17], sk[i1_6[ri_16, ri_17]], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17]) && (pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_6[ri_16, ri_17]], sk[ri_17]))) && (dh1 = exp(pkE_3[ri_16, ri_17], sk[ri_17])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying remove assignments of findcond
  - Remove assignments on dh_12 (definition removed, all usages removed)
  - Remove assignments on u_31 (definition removed, all usages removed)
  - Remove assignments on dh_11 (definition removed, all usages removed)
  - Remove assignments on dh_14 (definition removed, all usages removed)
  - Remove assignments on dh_13 (definition removed, all usages removed)
yields

Game 37 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63]) && (pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], sk)) = dh2[ri_62, ri_63]) && (exp(g, mult(sk[i1_10], z_2)) = dh1[ri_62, ri_63]) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (exp(pk_R, sk) = dh2[ri_50, ri_51]) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (exp(g, sk[i1_9]) = pk_S) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              pkR_5: G_t <- exp(g, sk);
              find [unique] u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39]) && (pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (exp(g, mult(sk[i1_6], sk)) = dh2[ri_38, ri_39]) && (exp(pkE_3, sk) = dh1[ri_38, ri_39]) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (exp(pk_S, sk) = dh2[ri_26, ri_27]) && (exp(pkE_3, sk) = dh1[ri_26, ri_27]) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(r_1[ri_20, ri_21], z_2[ri_20, ri_21], sk[ri_21], sk[i1_10[ri_20, ri_21]], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21]) && (pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_10[ri_20, ri_21]], sk[ri_21]))) && (dh1 = exp(g, mult(sk[i1_10[ri_20, ri_21]], z_2[ri_20, ri_21]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(r_3[ri_16, ri_17], sk[ri_17], sk[i1_6[ri_16, ri_17]], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17]) && (pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(g, mult(sk[i1_6[ri_16, ri_17]], sk[ri_17]))) && (dh1 = exp(pkE_3[ri_16, ri_17], sk[ri_17])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying equivalence gdh(exp) with z_2, sk. [probability Adv_sqGDH(time(context for game 37) + time + (1 + Qe * N + N) * time(exp), 4 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + (Qe * N + N) * PDistRerandom + (2 * Qe * Qe * N + N * N) * PCollKey]
  - Equivalence gdh(exp) with variables: sk -> a, z_2 -> a.
yields

Game 38 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (m_1: G_t <- pk_R; m'_1: G_t <- g; (m_1 = exp(m'_1, sk[i1_11]))) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
  {54}    find [unique] u_62 = ri_62 <= Qh, u_63 = ri_63 <= N suchthat defined(r_4[ri_62, ri_63], salt[ri_62, ri_63], protocol1[ri_62, ri_63], suite1[ri_62, ri_63], label1[ri_62, ri_63], dh1[ri_62, ri_63], dh2[ri_62, ri_63], l[ri_62, ri_63], protocol2[ri_62, ri_63], suite2[ri_62, ri_63], label2[ri_62, ri_63], pkE'[ri_62, ri_63], pkR'[ri_62, ri_63], pkS'[ri_62, ri_63]) && (pkS = pkS'[ri_62, ri_63]) && (pk_R = pkR'[ri_62, ri_63]) && (pkE_2 = pkE'[ri_62, ri_63]) && (label_shared_secret = label2[ri_62, ri_63]) && (suite_id = suite2[ri_62, ri_63]) && (RFCXXXX = protocol2[ri_62, ri_63]) && (I2OSP2(Nsecret) = l[ri_62, ri_63]) && (m_3: G_t <- dh2[ri_62, ri_63]; false) && (m_2: G_t <- dh1[ri_62, ri_63]; false) && (label_eae_prk = label1[ri_62, ri_63]) && (suite_id = suite1[ri_62, ri_63]) && (RFCXXXX = protocol1[ri_62, ri_63]) && (lbytes_empty = salt[ri_62, ri_63]) then
            zz_14: eae_output_t <- r_4[u_62, u_63];
            return(AuthEncap_tuple(r_4[u_62, u_63], enc_7))
          else
            r_1 <-R eae_output_t;
            zz_14: eae_output_t <- r_1;
            return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (m: G_t <- dh2[ri_50, ri_51]; m': G_t <- pk_R; (m = exp(m', sk))) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (m_9: G_t <- pk_S; m'_6: G_t <- g; (m_9 = exp(m'_6, sk[i1_9]))) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (m_6: G_t <- pk_S; m'_4: G_t <- g; (m_6 = exp(m'_4, sk[i1_7]))) then
              pkR_5: G_t <- exp(g, sk);
 {506}        find [unique] u_38 = ri_38 <= Qh, u_39 = ri_39 <= N suchthat defined(r_4[ri_38, ri_39], salt[ri_38, ri_39], protocol1[ri_38, ri_39], suite1[ri_38, ri_39], label1[ri_38, ri_39], dh1[ri_38, ri_39], dh2[ri_38, ri_39], l[ri_38, ri_39], protocol2[ri_38, ri_39], suite2[ri_38, ri_39], label2[ri_38, ri_39], pkE'[ri_38, ri_39], pkR'[ri_38, ri_39], pkS'[ri_38, ri_39]) && (pk_S = pkS'[ri_38, ri_39]) && (pkR_5 = pkR'[ri_38, ri_39]) && (pkE_3 = pkE'[ri_38, ri_39]) && (label_shared_secret = label2[ri_38, ri_39]) && (suite_id = suite2[ri_38, ri_39]) && (RFCXXXX = protocol2[ri_38, ri_39]) && (I2OSP2(Nsecret) = l[ri_38, ri_39]) && (m_8: G_t <- dh2[ri_38, ri_39]; false) && (m_7: G_t <- dh1[ri_38, ri_39]; m'_5: G_t <- pkE_3; (m_7 = exp(m'_5, sk))) && (label_eae_prk = label1[ri_38, ri_39]) && (suite_id = suite1[ri_38, ri_39]) && (RFCXXXX = protocol1[ri_38, ri_39]) && (lbytes_empty = salt[ri_38, ri_39]) then
                zz_12: eae_output_t <- r_4[u_38, u_39];
                return(AuthDecap_Some(r_4[u_38, u_39]))
              else
                r_3 <-R eae_output_t;
                zz_12: eae_output_t <- r_3;
                return(AuthDecap_Some(r_3))
            else
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (m_5: G_t <- dh2[ri_26, ri_27]; m'_3: G_t <- pk_S; (m_5 = exp(m'_3, sk))) && (m_4: G_t <- dh1[ri_26, ri_27]; m'_2: G_t <- pkE_3; (m_4 = exp(m'_2, sk))) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
 {893}    find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_10: G_t <- dh2; m'_7: G_t <- pk_R[ri_22, ri_23]; (m_10 = exp(m'_7, sk[ri_23]))) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_20 = ri_20 <= Qe, u_21 = ri_21 <= N suchthat defined(r_1[ri_20, ri_21], pkE_2[ri_20, ri_21], pk_R[ri_20, ri_21], pkS[ri_20, ri_21]) && (pkS' = pkS[ri_20, ri_21]) && (pkR' = pk_R[ri_20, ri_21]) && (pkE' = pkE_2[ri_20, ri_21]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_12: G_t <- dh2; false) && (m_11: G_t <- dh1; false) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_1[u_20, u_21])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_14: G_t <- dh2; m'_9: G_t <- pk_S[ri_18, ri_19]; (m_14 = exp(m'_9, sk[ri_19]))) && (m_13: G_t <- dh1; m'_8: G_t <- pkE_3[ri_18, ri_19]; (m_13 = exp(m'_8, sk[ri_19]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_16 = ri_16 <= Qd, u_17 = ri_17 <= N suchthat defined(r_3[ri_16, ri_17], sk[ri_17], pkE_3[ri_16, ri_17], pkR_5[ri_16, ri_17], pk_S[ri_16, ri_17]) && (pkS' = pk_S[ri_16, ri_17]) && (pkR' = pkR_5[ri_16, ri_17]) && (pkE' = pkE_3[ri_16, ri_17]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_16: G_t <- dh2; false) && (m_15: G_t <- dh1; m'_10: G_t <- pkE_3[ri_16, ri_17]; (m_15 = exp(m'_10, sk[ri_17]))) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_3[u_16, u_17])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying expand
  - Expand if/find/let
    - Remove branch 4 in find at 893
    - Remove branch 2 in find at 893
    - Remove branch 1 in find at 506
    - Find at 506 removed (else branch kept if any)
    - Remove branch 1 in find at 54
    - Find at 54 removed (else branch kept if any)
yields

Game 39 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (m_1: G_t <- pk_R; m'_1: G_t <- g; (m_1 = exp(m'_1, sk[i1_11]))) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          r_1 <-R eae_output_t;
          zz_14: eae_output_t <- r_1;
          return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (m: G_t <- dh2[ri_50, ri_51]; m': G_t <- pk_R; ((pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (m = exp(m', sk)) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]))) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(zz_14[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (m_9: G_t <- pk_S; m'_6: G_t <- g; ((i = i1_10[ie1_3, i1_9]) && (m_9 = exp(m'_6, sk[i1_9])) && (pkE_2[ie1_3, i1_9] = pkE_3))) then
            return(AuthDecap_Some(zz_14[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(zz_12[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(zz_12[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (m_6: G_t <- pk_S; m'_4: G_t <- g; (m_6 = exp(m'_4, sk[i1_7]))) then
              pkR_5: G_t <- exp(g, sk);
              r_3 <-R eae_output_t;
              zz_12: eae_output_t <- r_3;
              return(AuthDecap_Some(r_3))
            else
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (m_5: G_t <- dh2[ri_26, ri_27]; m'_3: G_t <- pk_S; m_4: G_t <- dh1[ri_26, ri_27]; m'_2: G_t <- pkE_3; ((pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (m_5 = exp(m'_3, sk)) && (m_4 = exp(m'_2, sk)) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]))) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (m_10: G_t <- dh2; m'_7: G_t <- pk_R[ri_22, ri_23]; ((pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_10 = exp(m'_7, sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty))) then
            return(r[u_22, u_23])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (m_14: G_t <- dh2; m'_9: G_t <- pk_S[ri_18, ri_19]; m_13: G_t <- dh1; m'_8: G_t <- pkE_3[ri_18, ri_19]; ((pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (m_14 = exp(m'_9, sk[ri_19])) && (m_13 = exp(m'_8, sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty))) then
            return(r_2[u_18, u_19])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying remove assignments of findcond
  - Remove assignments on m_10 (definition removed, all usages removed)
  - Remove assignments on m'_7 (definition removed, all usages removed)
  - Remove assignments on m_14 (definition removed, all usages removed)
  - Remove assignments on m'_9 (definition removed, all usages removed)
  - Remove assignments on m_13 (definition removed, all usages removed)
  - Remove assignments on m'_8 (definition removed, all usages removed)
  - Remove assignments on m_5 (definition removed, all usages removed)
  - Remove assignments on m'_3 (definition removed, all usages removed)
  - Remove assignments on m_4 (definition removed, all usages removed)
  - Remove assignments on m'_2 (definition removed, all usages removed)
  - Remove assignments on pkR_5 (definition removed, all usages removed)
  - Remove assignments on zz_12 (definition removed, all usages removed)
  - Remove assignments on m_6 (definition removed, all usages removed)
  - Remove assignments on m'_4 (definition removed, all usages removed)
  - Remove assignments on m_9 (definition removed, all usages removed)
  - Remove assignments on m'_6 (definition removed, all usages removed)
  - Remove assignments on m (definition removed, all usages removed)
  - Remove assignments on m' (definition removed, all usages removed)
  - Remove assignments on zz_14 (definition removed, all usages removed)
  - Remove assignments on m_1 (definition removed, all usages removed)
  - Remove assignments on m'_1 (definition removed, all usages removed)
yields

Game 40 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          r_1 <-R eae_output_t;
          return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (dh2[ri_50, ri_51] = exp(pk_R, sk)) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
 {235}    find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(r_1[ie1_3, i1_9], r_1[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (pk_S = exp(g, sk[i1_9])) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(r_1[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(r_3[id1_3], r_3[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(r_3[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              r_3 <-R eae_output_t;
              return(AuthDecap_Some(r_3))
            else
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (dh2[ri_26, ri_27] = exp(pk_S, sk)) && (dh1[ri_26, ri_27] = exp(pkE_3, sk)) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))


Applying simplify [probability (N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced defined condition r_3[id1_3], r_3[id1_3], pkE_3[id1_3], pk_S[id1_3] with r_3[id1_3], pkE_3[id1_3], pk_S[id1_3] in find at 235
    - Replaced defined condition r_1[ie1_3, i1_9], r_1[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9] with r_1[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9] in find at 235
yields

Game 41 is
      Ostart() :=
      return();
      foreach i <= N do
      Osetup() :=
      sk <-R Z_t;
      return();
      ((
        foreach ie <= Qe do
        OAEncap(pk_R: G_t) :=
        find i1_10 = i1_11 <= N suchthat defined(sk[i1_11]) && (pk_R = exp(g, sk[i1_11])) then
          z_2 <-R Z_t;
          pkE_2: G_t <- exp(g, z_2);
          enc_7: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          r_1 <-R eae_output_t;
          return(AuthEncap_tuple(r_1, enc_7))
        else
          z_3 <-R Z_t;
          pkE_2: G_t <- exp(g, z_3);
          enc_8: bitstring <- Serialize(pkE_2);
          pkS: G_t <- exp(g, sk);
          find [unique] u_50 = ri_50 <= Qh, u_51 = ri_51 <= N suchthat defined(r_4[ri_50, ri_51], salt[ri_50, ri_51], protocol1[ri_50, ri_51], suite1[ri_50, ri_51], label1[ri_50, ri_51], dh1[ri_50, ri_51], dh2[ri_50, ri_51], l[ri_50, ri_51], protocol2[ri_50, ri_51], suite2[ri_50, ri_51], label2[ri_50, ri_51], pkE'[ri_50, ri_51], pkR'[ri_50, ri_51], pkS'[ri_50, ri_51]) && (pkS = pkS'[ri_50, ri_51]) && (pk_R = pkR'[ri_50, ri_51]) && (pkE_2 = pkE'[ri_50, ri_51]) && (label_shared_secret = label2[ri_50, ri_51]) && (suite_id = suite2[ri_50, ri_51]) && (RFCXXXX = protocol2[ri_50, ri_51]) && (I2OSP2(Nsecret) = l[ri_50, ri_51]) && (dh2[ri_50, ri_51] = exp(pk_R, sk)) && (exp(pk_R, z_3) = dh1[ri_50, ri_51]) && (label_eae_prk = label1[ri_50, ri_51]) && (suite_id = suite1[ri_50, ri_51]) && (RFCXXXX = protocol1[ri_50, ri_51]) && (lbytes_empty = salt[ri_50, ri_51]) then
            return(AuthEncap_tuple(r_4[u_50, u_51], enc_8))
          else
            r <-R eae_output_t;
            return(AuthEncap_tuple(r, enc_8))
      ) | (
        foreach id <= Qd do
        OADecap(pk_S: G_t, enc_2: bitstring) :=
        let Serialize(pkE_3: G_t) = enc_2 in
          find ie1_2 = ie1_3 <= Qe, i1_8 = i1_9 <= N suchthat defined(r_1[ie1_3, i1_9], pkE_2[ie1_3, i1_9], sk[i1_9], i1_10[ie1_3, i1_9]) && (i = i1_10[ie1_3, i1_9]) && (pk_S = exp(g, sk[i1_9])) && (pkE_2[ie1_3, i1_9] = pkE_3) then
            return(AuthDecap_Some(r_1[ie1_2, i1_8]))
          orfind id1_2 = id1_3 <= Qd suchthat defined(r_3[id1_3], pkE_3[id1_3], pk_S[id1_3]) && (pk_S[id1_3] = pk_S) && (pkE_3[id1_3] = pkE_3) then
            return(AuthDecap_Some(r_3[id1_2]))
          else
            find i1_6 = i1_7 <= N suchthat defined(sk[i1_7]) && (pk_S = exp(g, sk[i1_7])) then
              r_3 <-R eae_output_t;
              return(AuthDecap_Some(r_3))
            else
              pkR_6: G_t <- exp(g, sk);
              find [unique] u_30 = ri_30 <= Qd suchthat defined(r_2[ri_30], pkE_3[ri_30], pk_S[ri_30]) && (pk_S = pk_S[ri_30]) && (pkE_3 = pkE_3[ri_30]) then
                return(AuthDecap_Some(r_2[u_30]))
              orfind u_26 = ri_26 <= Qh, u_27 = ri_27 <= N suchthat defined(r_4[ri_26, ri_27], salt[ri_26, ri_27], protocol1[ri_26, ri_27], suite1[ri_26, ri_27], label1[ri_26, ri_27], dh1[ri_26, ri_27], dh2[ri_26, ri_27], l[ri_26, ri_27], protocol2[ri_26, ri_27], suite2[ri_26, ri_27], label2[ri_26, ri_27], pkE'[ri_26, ri_27], pkR'[ri_26, ri_27], pkS'[ri_26, ri_27]) && (pk_S = pkS'[ri_26, ri_27]) && (pkR_6 = pkR'[ri_26, ri_27]) && (pkE_3 = pkE'[ri_26, ri_27]) && (label_shared_secret = label2[ri_26, ri_27]) && (suite_id = suite2[ri_26, ri_27]) && (RFCXXXX = protocol2[ri_26, ri_27]) && (I2OSP2(Nsecret) = l[ri_26, ri_27]) && (dh2[ri_26, ri_27] = exp(pk_S, sk)) && (dh1[ri_26, ri_27] = exp(pkE_3, sk)) && (label_eae_prk = label1[ri_26, ri_27]) && (suite_id = suite1[ri_26, ri_27]) && (RFCXXXX = protocol1[ri_26, ri_27]) && (lbytes_empty = salt[ri_26, ri_27]) then
                return(AuthDecap_Some(r_4[u_26, u_27]))
              else
                r_2 <-R eae_output_t;
                return(AuthDecap_Some(r_2))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk))
      ) | (
        foreach iH <= Qh do
        OH(x1: eae_input_t) :=
        let eae_input(salt: extract_salt_t, concatExtract(protocol1: label_protocol_t, suite1: suite_id_t, label1: label_extract_t, concatDH(dh1: G_t, dh2: G_t)), concatExpand(l: two_byte_t, protocol2: label_protocol_t, suite2: suite_id_t, label2: label_expand_t, concatContext(pkE': G_t, pkR': G_t, pkS': G_t))) = x1 in
          find [unique] u_22 = ri_22 <= Qe, u_23 = ri_23 <= N suchthat defined(r[ri_22, ri_23], z_3[ri_22, ri_23], sk[ri_23], pkE_2[ri_22, ri_23], pk_R[ri_22, ri_23], pkS[ri_22, ri_23]) && (pkS' = pkS[ri_22, ri_23]) && (pkR' = pk_R[ri_22, ri_23]) && (pkE' = pkE_2[ri_22, ri_23]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_R[ri_22, ri_23], sk[ri_23])) && (dh1 = exp(pk_R[ri_22, ri_23], z_3[ri_22, ri_23])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r[u_22, u_23])
          orfind u_18 = ri_18 <= Qd, u_19 = ri_19 <= N suchthat defined(r_2[ri_18, ri_19], sk[ri_19], pkE_3[ri_18, ri_19], pkR_6[ri_18, ri_19], pk_S[ri_18, ri_19]) && (pkS' = pk_S[ri_18, ri_19]) && (pkR' = pkR_6[ri_18, ri_19]) && (pkE' = pkE_3[ri_18, ri_19]) && (label2 = label_shared_secret) && (suite2 = suite_id) && (protocol2 = RFCXXXX) && (l = I2OSP2(Nsecret)) && (dh2 = exp(pk_S[ri_18, ri_19], sk[ri_19])) && (dh1 = exp(pkE_3[ri_18, ri_19], sk[ri_19])) && (label1 = label_eae_prk) && (suite1 = suite_id) && (protocol1 = RFCXXXX) && (salt = lbytes_empty) then
            return(r_2[u_18, u_19])
          orfind u_14 = ri_14 <= Qh, u_15 = ri_15 <= N suchthat defined(r_4[ri_14, ri_15], salt[ri_14, ri_15], protocol1[ri_14, ri_15], suite1[ri_14, ri_15], label1[ri_14, ri_15], dh1[ri_14, ri_15], dh2[ri_14, ri_15], l[ri_14, ri_15], protocol2[ri_14, ri_15], suite2[ri_14, ri_15], label2[ri_14, ri_15], pkE'[ri_14, ri_15], pkR'[ri_14, ri_15], pkS'[ri_14, ri_15]) && (pkS' = pkS'[ri_14, ri_15]) && (pkR' = pkR'[ri_14, ri_15]) && (pkE' = pkE'[ri_14, ri_15]) && (label2 = label2[ri_14, ri_15]) && (suite2 = suite2[ri_14, ri_15]) && (protocol2 = protocol2[ri_14, ri_15]) && (l = l[ri_14, ri_15]) && (dh2 = dh2[ri_14, ri_15]) && (dh1 = dh1[ri_14, ri_15]) && (label1 = label1[ri_14, ri_15]) && (suite1 = suite1[ri_14, ri_15]) && (protocol1 = protocol1[ri_14, ri_15]) && (salt = salt[ri_14, ri_15]) then
            return(r_4[u_14, u_15])
          else
            r_4 <-R eae_output_t;
            return(r_4)
        else
          find [unique] u = ri <= Qh, u_1 = ri_1 <= N suchthat defined(r_5[ri, ri_1], x1[ri, ri_1]) && (x1 = x1[ri, ri_1]) then
            return(r_5[u, u_1])
          else
            r_5 <-R eae_output_t;
            return(r_5)
      ))

Initial state
Game 42 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
  {18}  let AuthEncap_tuple(k: eae_output_t, ce: bitstring) = (skS_1: Z_t <- sk_1; {22}let (skE_1: Z_t, pkE_7: G_t) = (z_1 <-R Z_t; (z_1, exp(g, z_1))) in dh_7: GG_t <- concatDH(exp(pk_R_1, skE_1), exp(pk_R_1, skS_1)); enc_6: bitstring <- Serialize(pkE_7); pkS_3: G_t <- exp(g, skS_1); kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3); zz_7: eae_output_t <- (key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7); info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7); ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2))); AuthEncap_tuple(zz_7, enc_6) else AuthEncap_None) in
          return(AuthEncap_tuple(k, ce))
        else
          return(AuthEncap_None)
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(sk_1[i1_2], pk_R_1[ie1, i1_2], k[ie1, i1_2], ce[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && ((exponent_16: Z_t <- sk_1[i1_2]; exp(g, exponent_16)) = pk_S_1) && (ce[ie1, i1_2] = cd) then
          return(AuthDecap_Some(k[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd, i1_1 = i1_4 <= N suchthat defined(sk_1[i1_4], pk_S_1[id1, i1_4], k'[id1, i1_4], cd[id1, i1_4]) && (exp(g, sk_1) = (exponent_17: Z_t <- sk_1[i1_4]; exp(g, exponent_17))) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd) then
          return(AuthDecap_Some(k'[id1_1, i1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = (exponent_15: Z_t <- sk_1[i1]; exp(g, exponent_15))) then
 {240}      let AuthDecap_Some(k0: eae_output_t) = (skR_1: Z_t <- sk_1; let Serialize(pkE_9: G_t) = cd in dh_9: GG_t <- concatDH(exp(pkE_9, skR_1), exp(pk_S_1, skR_1)); pkR_4: G_t <- exp(g, skR_1); kemContext_9: GGG_t <- concatContext(pkE_9, pkR_4, pk_S_1); zz_9: eae_output_t <- (key_4: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_9); info_4: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_9); ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_4, info_4))); AuthDecap_Some(zz_9) else AuthDecap_None) in
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              return(AuthDecap_None)
          else
            return((skR_1: Z_t <- sk_1; let Serialize(pkE_8: G_t) = cd in dh_8: GG_t <- concatDH(exp(pkE_8, skR_1), exp(pk_S_1, skR_1)); pkR_3: G_t <- exp(g, skR_1); kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1); zz_8: eae_output_t <- (key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8); info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8); ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3))); AuthDecap_Some(zz_8) else AuthDecap_None))
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying expand
  - Expand if/find/let
    - Simplify pattern AuthDecap_Some(k0: eae_output_t) (tuple expanded) at 240
    - Remove else branch of let at 240
    - Simplify pattern (skE_1: Z_t, pkE_7: G_t) (tuple expanded) at 22
    - Remove else branch of let at 22
    - Simplify pattern AuthEncap_tuple(k: eae_output_t, ce: bitstring) (tuple expanded) at 18
    - Remove else branch of let at 18
yields

Game 43 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        skS_1: Z_t <- sk_1;
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        skE_1: Z_t <- z_1;
        dh_7: GG_t <- concatDH(exp(pk_R_1, skE_1), exp(pk_R_1, skS_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, skS_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        ce: bitstring <- enc_6;
        k: eae_output_t <- zz_7;
        return(AuthEncap_tuple(k, ce))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(sk_1[i1_2], pk_R_1[ie1, i1_2], k[ie1, i1_2], ce[ie1, i1_2]) && (exponent_16: Z_t <- sk_1[i1_2]; ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, exponent_16) = pk_S_1) && (ce[ie1, i1_2] = cd))) then
          return(AuthDecap_Some(k[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd, i1_1 = i1_4 <= N suchthat defined(sk_1[i1_4], pk_S_1[id1, i1_4], k'[id1, i1_4], cd[id1, i1_4]) && (exponent_17: Z_t <- sk_1[i1_4]; ((exp(g, sk_1) = exp(g, exponent_17)) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd))) then
          return(AuthDecap_Some(k'[id1_1, i1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (exponent_15: Z_t <- sk_1[i1]; (pk_S_1 = exp(g, exponent_15))) then
            skR_1: Z_t <- sk_1;
            let Serialize(pkE_9: G_t) = cd in
              dh_9: GG_t <- concatDH(exp(pkE_9, skR_1), exp(pk_S_1, skR_1));
              pkR_4: G_t <- exp(g, skR_1);
              kemContext_9: GGG_t <- concatContext(pkE_9, pkR_4, pk_S_1);
              key_4: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_9);
              info_4: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_9);
              zz_9: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_4, info_4));
              k0: eae_output_t <- zz_9;
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              let AuthDecap_Some(k0: eae_output_t) = AuthDecap_None in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
          else
            skR_1: Z_t <- sk_1;
            let Serialize(pkE_8: G_t) = cd in
              dh_8: GG_t <- concatDH(exp(pkE_8, skR_1), exp(pk_S_1, skR_1));
              pkR_3: G_t <- exp(g, skR_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
            else
              return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying remove assignments of findcond
  - Remove assignments on skR_1 (definition removed, all usages removed)
  - Remove assignments on skR_1 (definition removed, all usages removed)
  - Remove assignments on k0 (definition removed, all usages removed)
  - Remove assignments on exponent_15 (definition removed, all usages removed)
  - Remove assignments on exponent_16 (definition removed, all usages removed)
  - Remove assignments on exponent_17 (definition removed, all usages removed)
  - Remove assignments on skS_1 (definition removed, all usages removed)
  - Remove assignments on skE_1 (definition removed, all usages removed)
  - Remove assignments on ce (definition removed, all usages removed)
  - Remove assignments on k (definition removed, all usages removed)
  - Remove assignments on zz_9 (definition removed, all usages removed)
  - Remove assignments on key_4 (definition removed, all usages removed)
  - Remove assignments on info_4 (definition removed, all usages removed)
  - Remove assignments on dh_9 (definition removed, all usages removed)
  - Remove assignments on kemContext_9 (definition removed, all usages removed)
  - Remove assignments on pkR_4 (definition removed, all usages removed)
yields

Game 44 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
 {112}  find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], zz_7[ie1, i1_2], zz_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
          return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd, i1_1 = i1_4 <= N suchthat defined(sk_1[i1_4], pk_S_1[id1, i1_4], k'[id1, i1_4], cd[id1, i1_4]) && (exp(g, sk_1) = exp(g, sk_1[i1_4])) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd) then
          return(AuthDecap_Some(k'[id1_1, i1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            let Serialize(pkE_9: G_t) = cd in
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              let AuthDecap_Some(k0: eae_output_t) = AuthDecap_None in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
          else
            let Serialize(pkE_8: G_t) = cd in
              dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
            else
              return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition zz_7[ie1, i1_2], enc_6[ie1, i1_2], zz_7[ie1, i1_2], zz_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2] with zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2] in find at 112
yields

Game 45 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
 {112}  find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
          return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd, i1_1 = i1_4 <= N suchthat defined(sk_1[i1_4], pk_S_1[id1, i1_4], k'[id1, i1_4], cd[id1, i1_4]) && {163}((exp(g, sk_1) = exp(g, sk_1[i1_4])) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd)) then
          return(AuthDecap_Some(k'[id1_1, i1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            let Serialize(pkE_9: G_t) = cd in
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
 {221}        let AuthDecap_Some(k0: eae_output_t) = AuthDecap_None in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
          else
            let Serialize(pkE_8: G_t) = cd in
              dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
            else
              return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify [probability N * N * PCollKey]
  - Simplification pass
    - Remove let at 221
    - Replaced ((exp(g, sk_1) = exp(g, sk_1[i1_4])) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd)) with ((i_1 = i1_4) && (pk_S_1[id1, i1_4] = pk_S_1) && (cd[id1, i1_4] = cd)) at 163
    - In branch 2 of find at 112, substituting i1_1 with i_1
    - Replaced defined condition sk_1[i1_4], pk_S_1[id1, i1_4], k'[id1, i1_4], cd[id1, i1_4] with k'[id1], cd[id1], pk_S_1[id1] in find at 112
yields

Game 46 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
          return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && {162}((i_1 = i_1) && (pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) then
          i1_1 <= N <- i_1;
          return(AuthDecap_Some(k'[id1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            let Serialize(pkE_9: G_t) = cd in
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              return(AuthDecap_None)
          else
            let Serialize(pkE_8: G_t) = cd in
              dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
            else
              return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify
  - Simplification pass
    - Replaced ((i_1 = i_1) && (pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) with ((pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) at 162
yields

Game 47 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
 {112}  find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
          return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
        orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (cd[id1] = cd) then
          i1_1 <= N <- i_1;
          return(AuthDecap_Some(k'[id1_1]))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            let Serialize(pkE_9: G_t) = cd in
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              return(AuthDecap_None)
          else
            let Serialize(pkE_8: G_t) = cd in
              dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
            else
              return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying insert instruction let Serialize(pkE_10) = cd in at occurrence 112
yields

Game 48 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (cd[id1] = cd) then
            i1_1 <= N <- i_1;
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              let Serialize(pkE_9: G_t) = cd in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
            else
              let Serialize(pkE_8: G_t) = cd in
                dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
                pkR_3: G_t <- exp(g, sk_1);
                kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
                key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
                info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
                zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
                return(AuthDecap_Some(zz_8))
              else
                return(AuthDecap_None)
        else
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (cd[id1] = cd) then
            i1_1 <= N <- i_1;
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              let Serialize(pkE_9: G_t) = cd in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
            else
              let Serialize(pkE_8: G_t) = cd in
                dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
                pkR_3: G_t <- exp(g, sk_1);
                kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
                key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
                info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
                zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
                return(AuthDecap_Some(zz_8))
              else
                return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying remove assignments of findcond
  - Remove assignments on i1_1 (definition removed, all usages removed)
  - Remove assignments on i1_1 (definition removed, all usages removed)
yields

Game 49 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
 {116}    find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && {124}((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd)) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && {166}((pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
 {200}        let Serialize(pkE_9: G_t) = {201}cd in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
            else
 {216}        let Serialize(pkE_8: G_t) = {217}cd in
                dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
                pkR_3: G_t <- exp(g, sk_1);
                kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
                key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
                info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
                zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
                return(AuthDecap_Some(zz_8))
              else
                return(AuthDecap_None)
        else
 {296}    find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && {304}((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd)) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], cd[id1], pk_S_1[id1]) && {346}((pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
 {380}        let Serialize(pkE_9: G_t) = cd in
                k' <-R eae_output_t;
                return(AuthDecap_Some(k'))
              else
                return(AuthDecap_None)
            else
 {396}        let Serialize(pkE_8: G_t) = cd in
                dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
                pkR_3: G_t <- exp(g, sk_1);
                kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
                key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
                info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
                zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
                return(AuthDecap_Some(zz_8))
              else
                return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify
  - Simplification pass
    - Remove let at 396
    - Remove let at 380
    - Replaced ((pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) with false at 346
    - Remove branch 2 in find at 296
    - Replaced ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd)) with false at 304
    - Remove branch 1 in find at 296
    - Find at 296 removed (else branch kept if any)
    - Replaced cd with Serialize(pkE_10) at 217
    - Remove else branch of let at 216
    - Simplify pattern Serialize(pkE_8: G_t) (tuple expanded) at 216
    - Replaced cd with Serialize(pkE_10) at 201
    - Remove else branch of let at 200
    - Simplify pattern Serialize(pkE_9: G_t) (tuple expanded) at 200
    - Replaced ((pk_S_1[id1] = pk_S_1) && (cd[id1] = cd)) with ((pk_S_1[id1] = pk_S_1) && (pkE_9[id1] = pkE_10)) at 166
    - Replaced defined condition k'[id1], cd[id1], pk_S_1[id1] with k'[id1], pkE_9[id1], pk_S_1[id1] in find at 116
    - Replaced ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (enc_6[ie1, i1_2] = cd)) with ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) at 124
    - Replaced defined condition zz_7[ie1, i1_2], enc_6[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2] with zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2] in find at 116
yields

Game 50 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_9[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_9[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              pkE_9: G_t <- pkE_10;
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkE_8: G_t <- pkE_10;
              dh_8: GG_t <- concatDH(exp(pkE_8, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_8, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            return(AuthDecap_None)
          else
            return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying remove assignments of findcond
  - Remove assignments on pkE_8 (definition removed, all usages removed)
  - Remove assignments on pkE_9 (definition removed, all usages removed)
yields

Game 51 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(pkE_10[id1], k'[id1], k'[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
 {282}    find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
            return(AuthDecap_None)
          else
            return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying merge branches
  - Merge all branches of find at 282
yields

Game 52 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
  {18}  z_1 <-R Z_t;
        pkE_7: G_t <- exp(g, z_1);
        dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
        enc_6: bitstring <- Serialize(pkE_7);
        pkS_3: G_t <- exp(g, sk_1);
        kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
        key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
        info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
        zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
        return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(pkE_10[id1], k'[id1], k'[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying insert instruction find i1 <= N suchthat
      defined(sk_1[i1])
      && pk_R_1 = exp(g, sk_1[i1]) then at occurrence 18
yields

Game 53 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_1 <-R Z_t;
          pkE_7: G_t <- exp(g, z_1);
          dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
        else
          z_1 <-R Z_t;
          pkE_7: G_t <- exp(g, z_1);
          dh_7: GG_t <- concatDH(exp(pk_R_1, z_1), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(pkE_10[id1], k'[id1], k'[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename z_1
  - Rename variable z_1 into z_5, z_4
yields

Game 54 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_7: GG_t <- {36}concatDH(exp(pk_R_1, z_4), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_7: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
 {216}    find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(pkE_10[id1], k'[id1], k'[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify
  - Simplification pass
    - Replaced defined condition pkE_10[id1], k'[id1], k'[id1], pk_S_1[id1] with k'[id1], pkE_10[id1], pk_S_1[id1] in find at 216
    - Replaced concatDH(exp(pk_R_1, z_4), exp(pk_R_1, sk_1)) with concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1))) at 36
yields

Game 55 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_7: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_7: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_7);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename dh_7
  - Rename variable dh_7 into dh_16, dh_15
yields

Game 56 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_6: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_6))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename enc_6
  - Rename variable enc_6 into enc_10, enc_9
yields

Game 57 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_7: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_7);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename kemContext_7
  - Rename variable kemContext_7 into kemContext_15, kemContext_14
yields

Game 58 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_2: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_2, info_2));
          return(AuthEncap_tuple(zz_7, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename key_2
  - Rename variable key_2 into key_10, key_9
yields

Game 59 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_9, info_2));
          return(AuthEncap_tuple(zz_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_2: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_10, info_2));
          return(AuthEncap_tuple(zz_7, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename info_2
  - Rename variable info_2 into info_10, info_9
yields

Game 60 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_9, info_9));
          return(AuthEncap_tuple(zz_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_7: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_10, info_10));
          return(AuthEncap_tuple(zz_7, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && (exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying SA rename zz_7
  - Rename variable zz_7 into zz_17, zz_16
yields

Game 61 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_16: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_9, info_9));
          return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_17: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_10, info_10));
          return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
 {222}    find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && {230}((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_17[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2]) && {273}((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) then
            return(AuthDecap_Some(zz_17[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying simplify [probability (N * N + N * N * Qe) * PCollKey]
  - Simplification pass
    - Replaced ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) with false at 273
    - Remove branch 2 in find at 222
    - Replaced ((exp(g, sk_1) = pk_R_1[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) with ((i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10)) at 230
    - Replaced defined condition zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], pk_R_1[ie1, i1_2] with zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2] in find at 222
yields

Game 62 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_16: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_9, info_9));
          return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_17: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_10, info_10));
          return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
 {400}  return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying insert instruction let eae_input(
      salt: extract_salt_t,
      concatExtract(
        protocol1: label_protocol_t,
        suite1: suite_id_t,
        label1: label_extract_t,
        concatDH(dh1: G_t, dh2: G_t)),
      concatExpand(l: two_byte_t,
        protocol2: label_protocol_t,
        suite2: suite_id_t,
        label2: label_expand_t,
        concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in at occurrence 400
yields

Game 63 is
      Ostart() :=
      key_extr_10 <-R hash_key_t;
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_16: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_9, info_9));
          return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_17: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_10, info_10));
          return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- ExtractAndExpand_inner(key_extr_10, eae_input(lbytes_empty, key_3, info_3));
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          return(ExtractAndExpand_inner(key_extr_10, x1_1))
        else
          return(ExtractAndExpand_inner(key_extr_10, x1_1))
      ))


Applying equivalence rom(ExtractAndExpand_inner)
  - Equivalence rom(ExtractAndExpand_inner) with variables: key_extr_10 -> hk
yields

Game 64 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_16: eae_output_t <- (x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9); {104}find [unique] u_120 = ri_120 <= Qe, u_121 = ri_121 <= N suchthat defined(x_O_6[ri_120, ri_121], r_6[ri_120, ri_121]) && (x_O_7 = x_O_6[ri_120, ri_121]) then r_6[u_120, u_121] orfind u_118 = ri_118 <= Qe, u_119 = ri_119 <= N suchthat defined(x_O_7[ri_118, ri_119], r_7[ri_118, ri_119]) && (x_O_7 = x_O_7[ri_118, ri_119]) then r_7[u_118, u_119] orfind u_116 = ri_116 <= Qd, u_117 = ri_117 <= N suchthat defined(x_O_8[ri_116, ri_117], r_8[ri_116, ri_117]) && (x_O_7 = x_O_8[ri_116, ri_117]) then r_8[u_116, u_117] orfind u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(x_O_9[ri_114, ri_115], r_9[ri_114, ri_115]) && (x_O_7 = x_O_9[ri_114, ri_115]) then r_9[u_114, u_115] orfind u_112 = ri_112 <= Qh, u_113 = ri_113 <= N suchthat defined(x_O_10[ri_112, ri_113], r_10[ri_112, ri_113]) && {181}(x_O_7 = x_O_10[ri_112, ri_113]) then r_10[u_112, u_113] else r_7 <-R eae_output_t; r_7);
          return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_17: eae_output_t <- (x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10); {288}find [unique] u_110 = ri_110 <= Qe, u_111 = ri_111 <= N suchthat defined(x_O_6[ri_110, ri_111], r_6[ri_110, ri_111]) && (x_O_6 = x_O_6[ri_110, ri_111]) then r_6[u_110, u_111] orfind u_108 = ri_108 <= Qe, u_109 = ri_109 <= N suchthat defined(x_O_7[ri_108, ri_109], r_7[ri_108, ri_109]) && (x_O_6 = x_O_7[ri_108, ri_109]) then r_7[u_108, u_109] orfind u_106 = ri_106 <= Qd, u_107 = ri_107 <= N suchthat defined(x_O_8[ri_106, ri_107], r_8[ri_106, ri_107]) && (x_O_6 = x_O_8[ri_106, ri_107]) then r_8[u_106, u_107] orfind u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(x_O_9[ri_104, ri_105], r_9[ri_104, ri_105]) && (x_O_6 = x_O_9[ri_104, ri_105]) then r_9[u_104, u_105] orfind u_102 = ri_102 <= Qh, u_103 = ri_103 <= N suchthat defined(x_O_10[ri_102, ri_103], r_10[ri_102, ri_103]) && {365}(x_O_6 = x_O_10[ri_102, ri_103]) then r_10[u_102, u_103] else r_6 <-R eae_output_t; r_6);
          return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- (x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3); {556}find [unique] u_100 = ri_100 <= Qe, u_101 = ri_101 <= N suchthat defined(x_O_6[ri_100, ri_101], r_6[ri_100, ri_101]) && (x_O_8 = x_O_6[ri_100, ri_101]) then r_6[u_100, u_101] orfind u_98 = ri_98 <= Qe, u_99 = ri_99 <= N suchthat defined(x_O_7[ri_98, ri_99], r_7[ri_98, ri_99]) && (x_O_8 = x_O_7[ri_98, ri_99]) then r_7[u_98, u_99] orfind u_96 = ri_96 <= Qd, u_97 = ri_97 <= N suchthat defined(x_O_8[ri_96, ri_97], r_8[ri_96, ri_97]) && (x_O_8 = x_O_8[ri_96, ri_97]) then r_8[u_96, u_97] orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(x_O_9[ri_94, ri_95], r_9[ri_94, ri_95]) && (x_O_8 = x_O_9[ri_94, ri_95]) then r_9[u_94, u_95] orfind u_92 = ri_92 <= Qh, u_93 = ri_93 <= N suchthat defined(x_O_10[ri_92, ri_93], r_10[ri_92, ri_93]) && {633}(x_O_8 = x_O_10[ri_92, ri_93]) then r_10[u_92, u_93] else r_8 <-R eae_output_t; r_8);
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          return((x_O_9: eae_input_t <- x1_1; {691}find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(x_O_6[ri_90, ri_91], r_6[ri_90, ri_91]) && (x_O_9 = x_O_6[ri_90, ri_91]) then r_6[u_90, u_91] orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(x_O_7[ri_88, ri_89], r_7[ri_88, ri_89]) && (x_O_9 = x_O_7[ri_88, ri_89]) then r_7[u_88, u_89] orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(x_O_8[ri_86, ri_87], r_8[ri_86, ri_87]) && (x_O_9 = x_O_8[ri_86, ri_87]) then r_8[u_86, u_87] orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(x_O_9[ri_84, ri_85], r_9[ri_84, ri_85]) && (x_O_9 = x_O_9[ri_84, ri_85]) then r_9[u_84, u_85] orfind u_82 = ri_82 <= Qh, u_83 = ri_83 <= N suchthat defined(x_O_10[ri_82, ri_83], r_10[ri_82, ri_83]) && {768}(x_O_9 = x_O_10[ri_82, ri_83]) then r_10[u_82, u_83] else r_9 <-R eae_output_t; r_9))
        else
          return((x_O_10: eae_input_t <- x1_1; {793}find [unique] u_80 = ri_80 <= Qe, u_81 = ri_81 <= N suchthat defined(x_O_6[ri_80, ri_81], r_6[ri_80, ri_81]) && {798}(x_O_10 = x_O_6[ri_80, ri_81]) then r_6[u_80, u_81] orfind u_78 = ri_78 <= Qe, u_79 = ri_79 <= N suchthat defined(x_O_7[ri_78, ri_79], r_7[ri_78, ri_79]) && {816}(x_O_10 = x_O_7[ri_78, ri_79]) then r_7[u_78, u_79] orfind u_76 = ri_76 <= Qd, u_77 = ri_77 <= N suchthat defined(x_O_8[ri_76, ri_77], r_8[ri_76, ri_77]) && {834}(x_O_10 = x_O_8[ri_76, ri_77]) then r_8[u_76, u_77] orfind u_74 = ri_74 <= Qh, u_75 = ri_75 <= N suchthat defined(x_O_9[ri_74, ri_75], r_9[ri_74, ri_75]) && {852}(x_O_10 = x_O_9[ri_74, ri_75]) then r_9[u_74, u_75] orfind u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(x_O_10[ri_72, ri_73], r_10[ri_72, ri_73]) && (x_O_10 = x_O_10[ri_72, ri_73]) then r_10[u_72, u_73] else r_10 <-R eae_output_t; r_10))
      ))


Applying simplify (non-expanded game) [probability N * N * PCollKey]
  - Simplification pass
    - Replaced (x_O_7 = x_O_10[ri_112, ri_113]) with false at 181
    - Remove branch 5 in find at 104
    - Replaced (x_O_6 = x_O_10[ri_102, ri_103]) with false at 365
    - Remove branch 5 in find at 288
    - Replaced (x_O_8 = x_O_10[ri_92, ri_93]) with false at 633
    - Remove branch 5 in find at 556
    - Replaced (x_O_9 = x_O_10[ri_82, ri_83]) with false at 768
    - Remove branch 5 in find at 691
    - Replaced (x_O_10 = x_O_9[ri_74, ri_75]) with false at 852
    - Remove branch 4 in find at 793
    - Replaced (x_O_10 = x_O_8[ri_76, ri_77]) with false at 834
    - Remove branch 3 in find at 793
    - Replaced (x_O_10 = x_O_7[ri_78, ri_79]) with false at 816
    - Remove branch 2 in find at 793
    - Replaced (x_O_10 = x_O_6[ri_80, ri_81]) with false at 798
    - Remove branch 1 in find at 793
yields

Game 65 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          zz_16: eae_output_t <- (x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9); {104}find [unique] u_120 = ri_120 <= Qe, u_121 = ri_121 <= N suchthat defined(x_O_6[ri_120, ri_121], r_6[ri_120, ri_121]) && (x_O_7 = x_O_6[ri_120, ri_121]) then r_6[u_120, u_121] orfind u_118 = ri_118 <= Qe, u_119 = ri_119 <= N suchthat defined(x_O_7[ri_118, ri_119], r_7[ri_118, ri_119]) && (x_O_7 = x_O_7[ri_118, ri_119]) then r_7[u_118, u_119] orfind u_116 = ri_116 <= Qd, u_117 = ri_117 <= N suchthat defined(x_O_8[ri_116, ri_117], r_8[ri_116, ri_117]) && (x_O_7 = x_O_8[ri_116, ri_117]) then r_8[u_116, u_117] orfind u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(x_O_9[ri_114, ri_115], r_9[ri_114, ri_115]) && (x_O_7 = x_O_9[ri_114, ri_115]) then r_9[u_114, u_115] else r_7 <-R eae_output_t; r_7);
          return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          zz_17: eae_output_t <- (x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10); {270}find [unique] u_110 = ri_110 <= Qe, u_111 = ri_111 <= N suchthat defined(x_O_6[ri_110, ri_111], r_6[ri_110, ri_111]) && (x_O_6 = x_O_6[ri_110, ri_111]) then r_6[u_110, u_111] orfind u_108 = ri_108 <= Qe, u_109 = ri_109 <= N suchthat defined(x_O_7[ri_108, ri_109], r_7[ri_108, ri_109]) && (x_O_6 = x_O_7[ri_108, ri_109]) then r_7[u_108, u_109] orfind u_106 = ri_106 <= Qd, u_107 = ri_107 <= N suchthat defined(x_O_8[ri_106, ri_107], r_8[ri_106, ri_107]) && (x_O_6 = x_O_8[ri_106, ri_107]) then r_8[u_106, u_107] orfind u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(x_O_9[ri_104, ri_105], r_9[ri_104, ri_105]) && (x_O_6 = x_O_9[ri_104, ri_105]) then r_9[u_104, u_105] else r_6 <-R eae_output_t; r_6);
          return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              zz_8: eae_output_t <- (x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3); {520}find [unique] u_100 = ri_100 <= Qe, u_101 = ri_101 <= N suchthat defined(x_O_6[ri_100, ri_101], r_6[ri_100, ri_101]) && (x_O_8 = x_O_6[ri_100, ri_101]) then r_6[u_100, u_101] orfind u_98 = ri_98 <= Qe, u_99 = ri_99 <= N suchthat defined(x_O_7[ri_98, ri_99], r_7[ri_98, ri_99]) && (x_O_8 = x_O_7[ri_98, ri_99]) then r_7[u_98, u_99] orfind u_96 = ri_96 <= Qd, u_97 = ri_97 <= N suchthat defined(x_O_8[ri_96, ri_97], r_8[ri_96, ri_97]) && (x_O_8 = x_O_8[ri_96, ri_97]) then r_8[u_96, u_97] orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(x_O_9[ri_94, ri_95], r_9[ri_94, ri_95]) && (x_O_8 = x_O_9[ri_94, ri_95]) then r_9[u_94, u_95] else r_8 <-R eae_output_t; r_8);
              return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          return((x_O_9: eae_input_t <- x1_1; find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(x_O_6[ri_90, ri_91], r_6[ri_90, ri_91]) && (x_O_9 = x_O_6[ri_90, ri_91]) then r_6[u_90, u_91] orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(x_O_7[ri_88, ri_89], r_7[ri_88, ri_89]) && (x_O_9 = x_O_7[ri_88, ri_89]) then r_7[u_88, u_89] orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(x_O_8[ri_86, ri_87], r_8[ri_86, ri_87]) && (x_O_9 = x_O_8[ri_86, ri_87]) then r_8[u_86, u_87] orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(x_O_9[ri_84, ri_85], r_9[ri_84, ri_85]) && (x_O_9 = x_O_9[ri_84, ri_85]) then r_9[u_84, u_85] else r_9 <-R eae_output_t; r_9))
        else
          return((x_O_10: eae_input_t <- x1_1; find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(x_O_10[ri_72, ri_73], r_10[ri_72, ri_73]) && (x_O_10 = x_O_10[ri_72, ri_73]) then r_10[u_72, u_73] else r_10 <-R eae_output_t; r_10))
      ))


Applying expand [probability (4 * Qe * Qe * N + N * N + N * N * Qe + N * N * Qd) * PCollKey]
  - Expand if/find/let
    - Remove branch 2 in find at 520
    - Remove branch 1 in find at 520
    - Remove branch 3 in find at 270
    - Remove branch 2 in find at 270
    - Remove branch 1 in find at 270
    - Remove branch 3 in find at 104
    - Remove branch 2 in find at 104
    - Remove branch 1 in find at 104
yields

Game 66 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9);
          find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(x_O_9[ri_114, ri_115], r_9[ri_114, ri_115]) && (x_O_7 = x_O_9[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(zz_16, enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(zz_16, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(x_O_9[ri_104, ri_105], r_9[ri_104, ri_105]) && (x_O_6 = x_O_9[ri_104, ri_105]) then
            zz_17: eae_output_t <- r_9[u_104, u_105];
            return(AuthEncap_tuple(zz_17, enc_10))
          else
            r_6 <-R eae_output_t;
            zz_17: eae_output_t <- r_6;
            return(AuthEncap_tuple(zz_17, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3);
              find [unique] u_96 = ri_96 <= Qd, u_97 = ri_97 <= N suchthat defined(x_O_8[ri_96, ri_97], r_8[ri_96, ri_97]) && (x_O_8 = x_O_8[ri_96, ri_97]) then
                zz_8: eae_output_t <- r_8[u_96, u_97];
                return(AuthDecap_Some(zz_8))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(x_O_9[ri_94, ri_95], r_9[ri_94, ri_95]) && (x_O_8 = x_O_9[ri_94, ri_95]) then
                zz_8: eae_output_t <- r_9[u_94, u_95];
                return(AuthDecap_Some(zz_8))
              else
                r_8 <-R eae_output_t;
                zz_8: eae_output_t <- r_8;
                return(AuthDecap_Some(zz_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          x_O_9: eae_input_t <- x1_1;
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(x_O_6[ri_90, ri_91], r_6[ri_90, ri_91]) && (x_O_9 = x_O_6[ri_90, ri_91]) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(x_O_7[ri_88, ri_89], r_7[ri_88, ri_89]) && (x_O_9 = x_O_7[ri_88, ri_89]) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(x_O_8[ri_86, ri_87], r_8[ri_86, ri_87]) && (x_O_9 = x_O_8[ri_86, ri_87]) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(x_O_9[ri_84, ri_85], r_9[ri_84, ri_85]) && (x_O_9 = x_O_9[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          x_O_10: eae_input_t <- x1_1;
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(x_O_10[ri_72, ri_73], r_10[ri_72, ri_73]) && (x_O_10 = x_O_10[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying remove assignments of findcond
  - Remove assignments on x_O_10 (definition point kept, all usages removed)
  - Remove assignments on x_O_9 (definition point kept, all usages removed)
  - Remove assignments on zz_8 (definition removed, all usages removed)
  - Remove assignments on zz_8 (definition removed, all usages removed)
  - Remove assignments on zz_8 (definition removed, all usages removed)
  - Remove assignments on zz_17 (definition removed, all usages removed)
  - Remove assignments on zz_17 (definition removed, all usages removed)
  - Remove assignments on zz_16 (definition kept, array references kept)
  - Remove assignments on zz_16 (definition kept, array references kept)
yields

Game 67 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9);
 {103}    find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(x1_1[ri_114, ri_115], x_O_9[ri_114, ri_115], r_9[ri_114, ri_115]) && {110}(x_O_7 = x1_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10);
 {234}    find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(x1_1[ri_104, ri_105], x_O_9[ri_104, ri_105], r_9[ri_104, ri_105]) && {241}(x_O_6 = x1_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3);
 {435}        find [unique] u_96 = ri_96 <= Qd, u_97 = ri_97 <= N suchthat defined(x_O_8[ri_96, ri_97], r_8[ri_96, ri_97]) && {440}(x_O_8 = x_O_8[ri_96, ri_97]) then
                return(AuthDecap_Some(r_8[u_96, u_97]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(x1_1[ri_94, ri_95], x_O_9[ri_94, ri_95], r_9[ri_94, ri_95]) && {464}(x_O_8 = x1_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          x_O_9: eae_input_t <- cst_eae_input_t;
 {519}    find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(x_O_6[ri_90, ri_91], r_6[ri_90, ri_91]) && {524}(x1_1 = x_O_6[ri_90, ri_91]) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(x_O_7[ri_88, ri_89], r_7[ri_88, ri_89]) && {545}(x1_1 = x_O_7[ri_88, ri_89]) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(x_O_8[ri_86, ri_87], r_8[ri_86, ri_87]) && {566}(x1_1 = x_O_8[ri_86, ri_87]) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(x1_1[ri_84, ri_85], x_O_9[ri_84, ri_85], r_9[ri_84, ri_85]) && {589}(x1_1 = x1_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          x_O_10: eae_input_t <- cst_eae_input_t;
 {616}    find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(x1_1[ri_72, ri_73], x_O_10[ri_72, ri_73], r_10[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying simplify [probability (2 * N * N + N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced defined condition x1_1[ri_72, ri_73], x_O_10[ri_72, ri_73], r_10[ri_72, ri_73] with r_10[ri_72, ri_73], x1_1[ri_72, ri_73] in find at 616
    - Replaced (x1_1 = x1_1[ri_84, ri_85]) with ((pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85])) at 589
    - Replaced defined condition x1_1[ri_84, ri_85], x_O_9[ri_84, ri_85], r_9[ri_84, ri_85] with r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85] in find at 519
    - Replaced (x1_1 = x_O_8[ri_86, ri_87]) with ((pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty)) at 566
    - Replaced defined condition x_O_8[ri_86, ri_87], r_8[ri_86, ri_87] with r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87] in find at 519
    - Replaced (x1_1 = x_O_7[ri_88, ri_89]) with ((pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], sk_1[ri_89]))) && (dh1_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], z_4[ri_88, ri_89]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty)) at 545
    - Replaced defined condition x_O_7[ri_88, ri_89], r_7[ri_88, ri_89] with r_7[ri_88, ri_89], z_4[ri_88, ri_89], sk_1[ri_89], sk_1[i1_12[ri_88, ri_89]], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89] in find at 519
    - Replaced (x1_1 = x_O_6[ri_90, ri_91]) with ((pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty)) at 524
    - Replaced defined condition x_O_6[ri_90, ri_91], r_6[ri_90, ri_91] with r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91] in find at 519
    - Replaced (x_O_8 = x1_1[ri_94, ri_95]) with ((pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (exp(pk_S_1, sk_1) = dh2_1[ri_94, ri_95]) && (exp(pkE_10, sk_1) = dh1_1[ri_94, ri_95]) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95])) at 464
    - Replaced defined condition x1_1[ri_94, ri_95], x_O_9[ri_94, ri_95], r_9[ri_94, ri_95] with r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95] in find at 435
    - Replaced (x_O_8 = x_O_8[ri_96, ri_97]) with ((pk_S_1 = pk_S_1[ri_96, ri_97]) && (i_1 = ri_97) && (pkE_10 = pkE_10[ri_96, ri_97])) at 440
    - In branch 1 of find at 435, substituting u_97 with i_1
    - Replaced defined condition x_O_8[ri_96, ri_97], r_8[ri_96, ri_97] with r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96] in find at 435
    - Replaced (x_O_6 = x1_1[ri_104, ri_105]) with ((pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (exp(pk_R_1, sk_1) = dh2_1[ri_104, ri_105]) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105])) at 241
    - Replaced defined condition x1_1[ri_104, ri_105], x_O_9[ri_104, ri_105], r_9[ri_104, ri_105] with r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105] in find at 234
    - Replaced (x_O_7 = x1_1[ri_114, ri_115]) with ((pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], sk_1)) = dh2_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], z_4)) = dh1_1[ri_114, ri_115]) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115])) at 110
    - Replaced defined condition x1_1[ri_114, ri_115], x_O_9[ri_114, ri_115], r_9[ri_114, ri_115] with r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115] in find at 103
yields

Game 68 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9);
          find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115]) && (pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], sk_1)) = dh2_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], z_4)) = dh1_1[ri_114, ri_115]) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (exp(pk_R_1, sk_1) = dh2_1[ri_104, ri_105]) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && {668}((pk_S_1 = pk_S_1[ri_96]) && (i_1 = i_1) && (pkE_10 = pkE_10[ri_96])) then
                u_97 <= N <- i_1;
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (exp(pk_S_1, sk_1) = dh2_1[ri_94, ri_95]) && (exp(pkE_10, sk_1) = dh1_1[ri_94, ri_95]) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          x_O_9: eae_input_t <- cst_eae_input_t;
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(r_7[ri_88, ri_89], z_4[ri_88, ri_89], sk_1[ri_89], sk_1[i1_12[ri_88, ri_89]], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89]) && (pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], sk_1[ri_89]))) && (dh1_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], z_4[ri_88, ri_89]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          x_O_10: eae_input_t <- cst_eae_input_t;
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying simplify [probability (N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced ((pk_S_1 = pk_S_1[ri_96]) && (i_1 = i_1) && (pkE_10 = pkE_10[ri_96])) with ((pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96])) at 668
yields

Game 69 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_14: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_9: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_15);
          info_9: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_14);
          x_O_7: eae_input_t <- eae_input(lbytes_empty, key_9, info_9);
          find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115]) && (pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], sk_1)) = dh2_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], z_4)) = dh1_1[ri_114, ri_115]) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          kemContext_15: GGG_t <- concatContext(pkE_7, pk_R_1, pkS_3);
          key_10: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_16);
          info_10: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_15);
          x_O_6: eae_input_t <- eae_input(lbytes_empty, key_10, info_10);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (exp(pk_R_1, sk_1) = dh2_1[ri_104, ri_105]) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              kemContext_8: GGG_t <- concatContext(pkE_10, pkR_3, pk_S_1);
              key_3: extract_key_t <- concatExtract(RFCXXXX, suite_id, label_eae_prk, dh_8);
              info_3: expand_info_t <- concatExpand(I2OSP2(Nsecret), RFCXXXX, suite_id, label_shared_secret, kemContext_8);
              x_O_8: eae_input_t <- eae_input(lbytes_empty, key_3, info_3);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                u_97 <= N <- i_1;
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (exp(pk_S_1, sk_1) = dh2_1[ri_94, ri_95]) && (exp(pkE_10, sk_1) = dh1_1[ri_94, ri_95]) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          x_O_9: eae_input_t <- cst_eae_input_t;
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(r_7[ri_88, ri_89], z_4[ri_88, ri_89], sk_1[ri_89], sk_1[i1_12[ri_88, ri_89]], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89]) && (pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], sk_1[ri_89]))) && (dh1_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], z_4[ri_88, ri_89]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          x_O_10: eae_input_t <- cst_eae_input_t;
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying move all binders
  - Move assignment to x_O_10
  - Move assignment to x_O_9
  - Move assignment to x_O_8
  - Move assignment to info_3
  - Move assignment to key_3
  - Move assignment to kemContext_8
  - Move assignment to x_O_6
  - Move assignment to info_10
  - Move assignment to key_10
  - Move assignment to kemContext_15
  - Move assignment to x_O_7
  - Move assignment to info_9
  - Move assignment to key_9
  - Move assignment to kemContext_14
yields

Game 70 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          dh_15: GG_t <- concatDH(exp(g, mult(sk_1[i1_12], z_4)), exp(g, mult(sk_1[i1_12], sk_1)));
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115]) && (pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], sk_1)) = dh2_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], z_4)) = dh1_1[ri_114, ri_115]) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          dh_16: GG_t <- concatDH(exp(pk_R_1, z_5), exp(pk_R_1, sk_1));
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (exp(pk_R_1, sk_1) = dh2_1[ri_104, ri_105]) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              dh_8: GG_t <- concatDH(exp(pkE_10, sk_1), exp(pk_S_1, sk_1));
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                u_97 <= N <- i_1;
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (exp(pk_S_1, sk_1) = dh2_1[ri_94, ri_95]) && (exp(pkE_10, sk_1) = dh1_1[ri_94, ri_95]) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(r_7[ri_88, ri_89], z_4[ri_88, ri_89], sk_1[ri_89], sk_1[i1_12[ri_88, ri_89]], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89]) && (pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], sk_1[ri_89]))) && (dh1_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], z_4[ri_88, ri_89]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying remove assignments of findcond
  - Remove assignments on dh_8 (definition removed, all usages removed)
  - Remove assignments on u_97 (definition removed, all usages removed)
  - Remove assignments on dh_16 (definition removed, all usages removed)
  - Remove assignments on dh_15 (definition removed, all usages removed)
yields

Game 71 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115]) && (pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], sk_1)) = dh2_1[ri_114, ri_115]) && (exp(g, mult(sk_1[i1_12], z_4)) = dh1_1[ri_114, ri_115]) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (exp(pk_R_1, sk_1) = dh2_1[ri_104, ri_105]) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (exp(g, sk_1[i1_2]) = pk_S_1) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (exp(pk_S_1, sk_1) = dh2_1[ri_94, ri_95]) && (exp(pkE_10, sk_1) = dh1_1[ri_94, ri_95]) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(r_7[ri_88, ri_89], z_4[ri_88, ri_89], sk_1[ri_89], sk_1[i1_12[ri_88, ri_89]], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89]) && (pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], sk_1[ri_89]))) && (dh1_1 = exp(g, mult(sk_1[i1_12[ri_88, ri_89]], z_4[ri_88, ri_89]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying equivalence gdh(exp) [probability Adv_sqGDH(time(context for game 71) + time + (1 + Qe * N + N) * time(exp), 2 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + (Qe * N + N) * PDistRerandom + (2 * Qe * Qe * N + N * N) * PCollKey]
  - Equivalence gdh(exp) with variables: sk_1 -> a, z_4 -> a
yields

Game 72 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (m_28: G_t <- pk_R_1; m'_19: G_t <- g; (m_28 = exp(m'_19, sk_1[i1_13]))) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
  {54}    find [unique] u_114 = ri_114 <= Qh, u_115 = ri_115 <= N suchthat defined(r_9[ri_114, ri_115], salt_1[ri_114, ri_115], protocol1_1[ri_114, ri_115], suite1_1[ri_114, ri_115], label1_1[ri_114, ri_115], dh1_1[ri_114, ri_115], dh2_1[ri_114, ri_115], l_1[ri_114, ri_115], protocol2_1[ri_114, ri_115], suite2_1[ri_114, ri_115], label2_1[ri_114, ri_115], pkE''[ri_114, ri_115], pkR''[ri_114, ri_115], pkS''[ri_114, ri_115]) && (pkS_3 = pkS''[ri_114, ri_115]) && (pk_R_1 = pkR''[ri_114, ri_115]) && (pkE_7 = pkE''[ri_114, ri_115]) && (label_shared_secret = label2_1[ri_114, ri_115]) && (suite_id = suite2_1[ri_114, ri_115]) && (RFCXXXX = protocol2_1[ri_114, ri_115]) && (I2OSP2(Nsecret) = l_1[ri_114, ri_115]) && (m_29: G_t <- dh2_1[ri_114, ri_115]; false) && (m_17: G_t <- dh1_1[ri_114, ri_115]; false) && (label_eae_prk = label1_1[ri_114, ri_115]) && (suite_id = suite1_1[ri_114, ri_115]) && (RFCXXXX = protocol1_1[ri_114, ri_115]) && (lbytes_empty = salt_1[ri_114, ri_115]) then
            zz_16: eae_output_t <- r_9[u_114, u_115];
            return(AuthEncap_tuple(r_9[u_114, u_115], enc_9))
          else
            r_7 <-R eae_output_t;
            zz_16: eae_output_t <- r_7;
            return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (m_27: G_t <- dh2_1[ri_104, ri_105]; m'_18: G_t <- pk_R_1; (m_27 = exp(m'_18, sk_1))) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (m_21: G_t <- pk_S_1; m'_14: G_t <- g; (m_21 = exp(m'_14, sk_1[i1_2]))) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (m_20: G_t <- pk_S_1; m'_13: G_t <- g; (m_20 = exp(m'_13, sk_1[i1]))) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (m_19: G_t <- dh2_1[ri_94, ri_95]; m'_12: G_t <- pk_S_1; (m_19 = exp(m'_12, sk_1))) && (m_18: G_t <- dh1_1[ri_94, ri_95]; m'_11: G_t <- pkE_10; (m_18 = exp(m'_11, sk_1))) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
 {732}    find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (m_22: G_t <- dh2_1; m'_15: G_t <- pk_R_1[ri_90, ri_91]; (m_22 = exp(m'_15, sk_1[ri_91]))) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_88 = ri_88 <= Qe, u_89 = ri_89 <= N suchthat defined(r_7[ri_88, ri_89], pkE_7[ri_88, ri_89], pk_R_1[ri_88, ri_89], pkS_3[ri_88, ri_89]) && (pkS'' = pkS_3[ri_88, ri_89]) && (pkR'' = pk_R_1[ri_88, ri_89]) && (pkE'' = pkE_7[ri_88, ri_89]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (m_24: G_t <- dh2_1; false) && (m_23: G_t <- dh1_1; false) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_7[u_88, u_89])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (m_26: G_t <- dh2_1; m'_17: G_t <- pk_S_1[ri_86, ri_87]; (m_26 = exp(m'_17, sk_1[ri_87]))) && (m_25: G_t <- dh1_1; m'_16: G_t <- pkE_10[ri_86, ri_87]; (m_25 = exp(m'_16, sk_1[ri_87]))) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying expand
  - Expand if/find/let
    - Remove branch 2 in find at 732
    - Remove branch 1 in find at 54
    - Find at 54 removed (else branch kept if any)
yields

Game 73 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (m_28: G_t <- pk_R_1; m'_19: G_t <- g; (m_28 = exp(m'_19, sk_1[i1_13]))) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          r_7 <-R eae_output_t;
          zz_16: eae_output_t <- r_7;
          return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (m_27: G_t <- dh2_1[ri_104, ri_105]; m'_18: G_t <- pk_R_1; ((pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (m_27 = exp(m'_18, sk_1)) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]))) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(zz_16[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (m_21: G_t <- pk_S_1; m'_14: G_t <- g; ((i_1 = i1_12[ie1, i1_2]) && (m_21 = exp(m'_14, sk_1[i1_2])) && (pkE_7[ie1, i1_2] = pkE_10))) then
            return(AuthDecap_Some(zz_16[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (m_20: G_t <- pk_S_1; m'_13: G_t <- g; (m_20 = exp(m'_13, sk_1[i1]))) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (m_19: G_t <- dh2_1[ri_94, ri_95]; m'_12: G_t <- pk_S_1; m_18: G_t <- dh1_1[ri_94, ri_95]; m'_11: G_t <- pkE_10; ((pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (m_19 = exp(m'_12, sk_1)) && (m_18 = exp(m'_11, sk_1)) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]))) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (m_22: G_t <- dh2_1; m'_15: G_t <- pk_R_1[ri_90, ri_91]; ((pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (m_22 = exp(m'_15, sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty))) then
            return(r_6[u_90, u_91])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (m_26: G_t <- dh2_1; m'_17: G_t <- pk_S_1[ri_86, ri_87]; m_25: G_t <- dh1_1; m'_16: G_t <- pkE_10[ri_86, ri_87]; ((pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (m_26 = exp(m'_17, sk_1[ri_87])) && (m_25 = exp(m'_16, sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty))) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying remove assignments of findcond
  - Remove assignments on m_22 (definition removed, all usages removed)
  - Remove assignments on m'_15 (definition removed, all usages removed)
  - Remove assignments on m_26 (definition removed, all usages removed)
  - Remove assignments on m'_17 (definition removed, all usages removed)
  - Remove assignments on m_25 (definition removed, all usages removed)
  - Remove assignments on m'_16 (definition removed, all usages removed)
  - Remove assignments on m_19 (definition removed, all usages removed)
  - Remove assignments on m'_12 (definition removed, all usages removed)
  - Remove assignments on m_18 (definition removed, all usages removed)
  - Remove assignments on m'_11 (definition removed, all usages removed)
  - Remove assignments on m_20 (definition removed, all usages removed)
  - Remove assignments on m'_13 (definition removed, all usages removed)
  - Remove assignments on m_21 (definition removed, all usages removed)
  - Remove assignments on m'_14 (definition removed, all usages removed)
  - Remove assignments on m_27 (definition removed, all usages removed)
  - Remove assignments on m'_18 (definition removed, all usages removed)
  - Remove assignments on zz_16 (definition removed, all usages removed)
  - Remove assignments on m_28 (definition removed, all usages removed)
  - Remove assignments on m'_19 (definition removed, all usages removed)
yields

Game 74 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          r_7 <-R eae_output_t;
          return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (dh2_1[ri_104, ri_105] = exp(pk_R_1, sk_1)) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
 {235}    find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(r_7[ie1, i1_2], r_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (pk_S_1 = exp(g, sk_1[i1_2])) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(r_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (dh2_1[ri_94, ri_95] = exp(pk_S_1, sk_1)) && (dh1_1[ri_94, ri_95] = exp(pkE_10, sk_1)) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Applying simplify [probability (N * N * Qe + N * N * Qd) * PCollKey]
  - Simplification pass
    - Replaced defined condition r_7[ie1, i1_2], r_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2] with r_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2] in find at 235
yields

Game 75 is
      Ostart() :=
      return();
      foreach i_1 <= N do
      Osetup() :=
      sk_1 <-R Z_t;
      return();
      ((
        foreach ie_1 <= Qe do
        OAEncap(pk_R_1: G_t) :=
        find i1_12 = i1_13 <= N suchthat defined(sk_1[i1_13]) && (pk_R_1 = exp(g, sk_1[i1_13])) then
          z_4 <-R Z_t;
          pkE_7: G_t <- exp(g, z_4);
          enc_9: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          r_7 <-R eae_output_t;
          return(AuthEncap_tuple(r_7, enc_9))
        else
          z_5 <-R Z_t;
          pkE_7: G_t <- exp(g, z_5);
          enc_10: bitstring <- Serialize(pkE_7);
          pkS_3: G_t <- exp(g, sk_1);
          find [unique] u_104 = ri_104 <= Qh, u_105 = ri_105 <= N suchthat defined(r_9[ri_104, ri_105], salt_1[ri_104, ri_105], protocol1_1[ri_104, ri_105], suite1_1[ri_104, ri_105], label1_1[ri_104, ri_105], dh1_1[ri_104, ri_105], dh2_1[ri_104, ri_105], l_1[ri_104, ri_105], protocol2_1[ri_104, ri_105], suite2_1[ri_104, ri_105], label2_1[ri_104, ri_105], pkE''[ri_104, ri_105], pkR''[ri_104, ri_105], pkS''[ri_104, ri_105]) && (pkS_3 = pkS''[ri_104, ri_105]) && (pk_R_1 = pkR''[ri_104, ri_105]) && (pkE_7 = pkE''[ri_104, ri_105]) && (label_shared_secret = label2_1[ri_104, ri_105]) && (suite_id = suite2_1[ri_104, ri_105]) && (RFCXXXX = protocol2_1[ri_104, ri_105]) && (I2OSP2(Nsecret) = l_1[ri_104, ri_105]) && (dh2_1[ri_104, ri_105] = exp(pk_R_1, sk_1)) && (exp(pk_R_1, z_5) = dh1_1[ri_104, ri_105]) && (label_eae_prk = label1_1[ri_104, ri_105]) && (suite_id = suite1_1[ri_104, ri_105]) && (RFCXXXX = protocol1_1[ri_104, ri_105]) && (lbytes_empty = salt_1[ri_104, ri_105]) then
            return(AuthEncap_tuple(r_9[u_104, u_105], enc_10))
          else
            r_6 <-R eae_output_t;
            return(AuthEncap_tuple(r_6, enc_10))
      ) | (
        foreach id_1 <= Qd do
        OADecap(pk_S_1: G_t, cd: bitstring) :=
        let Serialize(pkE_10: G_t) = cd in
          find ie1_1 = ie1 <= Qe, i1_1 = i1_2 <= N suchthat defined(r_7[ie1, i1_2], pkE_7[ie1, i1_2], sk_1[i1_2], i1_12[ie1, i1_2]) && (i_1 = i1_12[ie1, i1_2]) && (pk_S_1 = exp(g, sk_1[i1_2])) && (pkE_7[ie1, i1_2] = pkE_10) then
            return(AuthDecap_Some(r_7[ie1_1, i1_1]))
          orfind id1_1 = id1 <= Qd suchthat defined(k'[id1], pkE_10[id1], pk_S_1[id1]) && (pk_S_1[id1] = pk_S_1) && (pkE_10[id1] = pkE_10) then
            return(AuthDecap_Some(k'[id1_1]))
          else
            find i1_1 = i1 <= N suchthat defined(sk_1[i1]) && (pk_S_1 = exp(g, sk_1[i1])) then
              k' <-R eae_output_t;
              return(AuthDecap_Some(k'))
            else
              pkR_3: G_t <- exp(g, sk_1);
              find [unique] u_96 = ri_96 <= Qd suchthat defined(r_8[ri_96], pkE_10[ri_96], pk_S_1[ri_96]) && (pk_S_1 = pk_S_1[ri_96]) && (pkE_10 = pkE_10[ri_96]) then
                return(AuthDecap_Some(r_8[u_96]))
              orfind u_94 = ri_94 <= Qh, u_95 = ri_95 <= N suchthat defined(r_9[ri_94, ri_95], salt_1[ri_94, ri_95], protocol1_1[ri_94, ri_95], suite1_1[ri_94, ri_95], label1_1[ri_94, ri_95], dh1_1[ri_94, ri_95], dh2_1[ri_94, ri_95], l_1[ri_94, ri_95], protocol2_1[ri_94, ri_95], suite2_1[ri_94, ri_95], label2_1[ri_94, ri_95], pkE''[ri_94, ri_95], pkR''[ri_94, ri_95], pkS''[ri_94, ri_95]) && (pk_S_1 = pkS''[ri_94, ri_95]) && (pkR_3 = pkR''[ri_94, ri_95]) && (pkE_10 = pkE''[ri_94, ri_95]) && (label_shared_secret = label2_1[ri_94, ri_95]) && (suite_id = suite2_1[ri_94, ri_95]) && (RFCXXXX = protocol2_1[ri_94, ri_95]) && (I2OSP2(Nsecret) = l_1[ri_94, ri_95]) && (dh2_1[ri_94, ri_95] = exp(pk_S_1, sk_1)) && (dh1_1[ri_94, ri_95] = exp(pkE_10, sk_1)) && (label_eae_prk = label1_1[ri_94, ri_95]) && (suite_id = suite1_1[ri_94, ri_95]) && (RFCXXXX = protocol1_1[ri_94, ri_95]) && (lbytes_empty = salt_1[ri_94, ri_95]) then
                return(AuthDecap_Some(r_9[u_94, u_95]))
              else
                r_8 <-R eae_output_t;
                return(AuthDecap_Some(r_8))
        else
          return(AuthDecap_None)
      ) | (
        Opk() :=
        return(exp(g, sk_1))
      ) | (
        foreach iH_1 <= Qh do
        OH(x1_1: eae_input_t) :=
        let eae_input(salt_1: extract_salt_t, concatExtract(protocol1_1: label_protocol_t, suite1_1: suite_id_t, label1_1: label_extract_t, concatDH(dh1_1: G_t, dh2_1: G_t)), concatExpand(l_1: two_byte_t, protocol2_1: label_protocol_t, suite2_1: suite_id_t, label2_1: label_expand_t, concatContext(pkE'': G_t, pkR'': G_t, pkS'': G_t))) = x1_1 in
          find [unique] u_90 = ri_90 <= Qe, u_91 = ri_91 <= N suchthat defined(r_6[ri_90, ri_91], z_5[ri_90, ri_91], sk_1[ri_91], pkE_7[ri_90, ri_91], pk_R_1[ri_90, ri_91], pkS_3[ri_90, ri_91]) && (pkS'' = pkS_3[ri_90, ri_91]) && (pkR'' = pk_R_1[ri_90, ri_91]) && (pkE'' = pkE_7[ri_90, ri_91]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_R_1[ri_90, ri_91], sk_1[ri_91])) && (dh1_1 = exp(pk_R_1[ri_90, ri_91], z_5[ri_90, ri_91])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_6[u_90, u_91])
          orfind u_86 = ri_86 <= Qd, u_87 = ri_87 <= N suchthat defined(r_8[ri_86, ri_87], sk_1[ri_87], pkE_10[ri_86, ri_87], pkR_3[ri_86, ri_87], pk_S_1[ri_86, ri_87]) && (pkS'' = pk_S_1[ri_86, ri_87]) && (pkR'' = pkR_3[ri_86, ri_87]) && (pkE'' = pkE_10[ri_86, ri_87]) && (label2_1 = label_shared_secret) && (suite2_1 = suite_id) && (protocol2_1 = RFCXXXX) && (l_1 = I2OSP2(Nsecret)) && (dh2_1 = exp(pk_S_1[ri_86, ri_87], sk_1[ri_87])) && (dh1_1 = exp(pkE_10[ri_86, ri_87], sk_1[ri_87])) && (label1_1 = label_eae_prk) && (suite1_1 = suite_id) && (protocol1_1 = RFCXXXX) && (salt_1 = lbytes_empty) then
            return(r_8[u_86, u_87])
          orfind u_84 = ri_84 <= Qh, u_85 = ri_85 <= N suchthat defined(r_9[ri_84, ri_85], salt_1[ri_84, ri_85], protocol1_1[ri_84, ri_85], suite1_1[ri_84, ri_85], label1_1[ri_84, ri_85], dh1_1[ri_84, ri_85], dh2_1[ri_84, ri_85], l_1[ri_84, ri_85], protocol2_1[ri_84, ri_85], suite2_1[ri_84, ri_85], label2_1[ri_84, ri_85], pkE''[ri_84, ri_85], pkR''[ri_84, ri_85], pkS''[ri_84, ri_85]) && (pkS'' = pkS''[ri_84, ri_85]) && (pkR'' = pkR''[ri_84, ri_85]) && (pkE'' = pkE''[ri_84, ri_85]) && (label2_1 = label2_1[ri_84, ri_85]) && (suite2_1 = suite2_1[ri_84, ri_85]) && (protocol2_1 = protocol2_1[ri_84, ri_85]) && (l_1 = l_1[ri_84, ri_85]) && (dh2_1 = dh2_1[ri_84, ri_85]) && (dh1_1 = dh1_1[ri_84, ri_85]) && (label1_1 = label1_1[ri_84, ri_85]) && (suite1_1 = suite1_1[ri_84, ri_85]) && (protocol1_1 = protocol1_1[ri_84, ri_85]) && (salt_1 = salt_1[ri_84, ri_85]) then
            return(r_9[u_84, u_85])
          else
            r_9 <-R eae_output_t;
            return(r_9)
        else
          find [unique] u_72 = ri_72 <= Qh, u_73 = ri_73 <= N suchthat defined(r_10[ri_72, ri_73], x1_1[ri_72, ri_73]) && (x1_1 = x1_1[ri_72, ri_73]) then
            return(r_10[u_72, u_73])
          else
            r_10 <-R eae_output_t;
            return(r_10)
      ))


Proved indistinguishability between game 75 and game 1
Game 75 is the same as game 41.
Adv[Game 1: indistinguishability from game 41] <= Adv_sqGDH(time_1, 4 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + (N + Qe * N) * PDistRerandom + (N * Qe * Qd + 4 * N * N * Qd + 6 * Qe * Qe * N + 5 * N * N * Qe + 13 * N * N) * PCollKey + Adv[Game 41: indistinguishability from game 41]
Adv[Game 41: indistinguishability from game 41] <= 0
Adv[Game 42: indistinguishability from game 75] <= Adv_sqGDH(time_2, 2 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + (N + Qe * N) * PDistRerandom + (4 * N * N * Qd + 6 * Qe * Qe * N + 5 * N * N * Qe + 7 * N * N) * PCollKey + Adv[Game 75: indistinguishability from game 75]
Adv[Game 75: indistinguishability from game 75] <= 0
RESULT Proved indistinguishability between game 42 and game 1 up to probability Adv_sqGDH(time_2, 2 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + Adv_sqGDH(time_1, 4 * Qh * Qd * N + 3 * Qh * N * N + N * N * Qe + N * N * Qd) + (2 * N + 2 * Qe * N) * PDistRerandom + (N * Qe * Qd + 8 * N * N * Qd + 12 * Qe * Qe * N + 10 * N * N * Qe + 20 * N * N) * PCollKey
RESULT time_1 = time(context for game 37) + time + (1 + Qe * N + N) * time(exp)
RESULT time_2 = time(context for game 71) + time + (1 + Qe * N + N) * time(exp)
RESULT time(context for game 37) = Qh * N * time(let concatDH) + Qh * N * time(let concatExtract) + Qh * N * time(let concatContext) + Qh * N * time(let concatExpand) + Qh * N * time(let eae_input) + (3 * Qd * N * N * Qh + 3 * Qe * N * N * Qh) * time(I2OSP2) + (2 * Qe * N * N * Qh + Qe * N) * time(exp) + Qd * N * time(let Serialize) + Qd * N * time(AuthDecap_Some) + Qe * N * time(AuthEncap_tuple, maxlength(game 37: enc_7)) + Qe * N * time(Serialize) + Qe * N * time(AuthEncap_tuple, maxlength(game 37: enc_8))
RESULT time(context for game 71) = Qh * N * time(let concatDH) + Qh * N * time(let concatExtract) + Qh * N * time(let concatContext) + Qh * N * time(let concatExpand) + Qh * N * time(let eae_input) + (2 * Qd * N * N * Qh + 3 * Qe * N * N * Qh) * time(I2OSP2) + (2 * Qe * N * N * Qh + Qe * N) * time(exp) + Qd * N * time(let Serialize) + Qd * N * time(AuthDecap_Some) + Qe * N * time(AuthEncap_tuple, maxlength(game 71: enc_9)) + Qe * N * time(Serialize) + Qe * N * time(AuthEncap_tuple, maxlength(game 71: enc_10))
All queries proved.
